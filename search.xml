<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>博客结构</title>
    <url>/2021/09/13/blog002-2021-09-13/</url>
    <content><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2>
<p>一个EE的博客。</p>
<ul>
<li>日常的制作进度，开坑想法，小成果等，会放<code>EE-随笔</code><strong>分类</strong>中，这些仅作记录，并没有完整的工程结构。</li>
<li>一个完整的项目，会放在特定的<strong>分类</strong>中，并会围绕此，结合Github仓库，构建工程。</li>
</ul>
]]></content>
      <categories>
        <category>生活-随笔</category>
      </categories>
      <tags>
        <tag>生活</tag>
      </tags>
  </entry>
  <entry>
    <title>【EE随笔-1】HMC189A倍频器</title>
    <url>/2021/09/13/blog003-2021-09-13/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="随笔"><a class="markdownIt-Anchor" href="#随笔"></a> 随笔</h2>
<p>HMC189A是<strong>Hittile</strong>的老产品，现在在<strong>Analog</strong>公司下已显示淘汰了：</p>
<p><a href="https://www.analog.com/en/products/hmc189a.html">https://www.analog.com/en/products/hmc189a.html</a></p>
<p>不过呢，这玩意是2-4GHz输入的<strong>2倍频器</strong>，也就是说，用常见的2.4GHz锁相环合成器搭配它，就能跃升至C波段，再也不用望着那些昂贵（且没啥拆机货）的C波段PLL、VCO流口水啦！当然HMC189A本身也是非常的便宜。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-1.png" alt="1-1" /></p>
<p>做了个小模块，用的是<strong>JLCPCB</strong>的四层阻抗工艺，7628层压结构。输入由ADF4351模块提供。ADF4351无分频的输出范围是2200-4400MHz，在这一段是较为纯净的正弦波。当然这个范围也正和HMC189A“般配”。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-2.jpg" alt="1-2" /></p>
<p>在大扫频范围下观察输出，感觉隔离度起码有20dB以上吧（只是随便测下）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-3.jpg" alt="1-3" /></p>
<p>倍频至5.8GHz，频谱仪开了10dB衰减，又外接了10dB衰减器：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-4.jpg" alt="1-4" /></p>
<p>挑战一把8GHz：（至少还是有输出的）</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-5.jpg" alt="1-5" /></p>
<p>其实此时，锁相环模块的输出功率已经衰减了很多，应该是模块上的滤波网络并没有做好支持。此外，HMC189A的需求十分吓人，输入功率要达到+15dBm才能达到最佳性能：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog003-2021-09-13/1-6.png" alt="1-6" /></p>
<h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2>
<p>发现这个倍频器真的是十分开心，S波段的PLL——ADF4350也是拆机市场上的常客，这下C波段FMCW雷达项目的成本又可以大大降低了。</p>
]]></content>
      <categories>
        <category>EE-随笔</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>CASIO fx-50F Calculator</title>
    <url>/2021/09/22/blog006-2021-09-22/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/title.jpg" alt="title" /></p>
<span id="more"></span>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-1.jpg" alt="1-1" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-2.jpg" alt="1-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-3.jpg" alt="1-3" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-4.jpg" alt="1-4" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-5.jpg" alt="1-5" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog006-2021-09-22/1-6.jpg" alt="1-6" /></p>
<blockquote>
<p>施工中</p>
</blockquote>
]]></content>
      <categories>
        <category>计算器</category>
      </categories>
      <tags>
        <tag>CASIO</tag>
        <tag>Vintage</tag>
      </tags>
  </entry>
  <entry>
    <title>HP-12C Calculator</title>
    <url>/2021/09/22/blog007-2021-09-22/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/title.JPG" alt="title" /></p>
<span id="more"></span>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-1.jpg" alt="1-1" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-2.jpg" alt="1-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-3.jpg" alt="1-3" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-4.jpg" alt="1-4" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-5.jpg" alt="1-5" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-6.jpg" alt="1-6" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-7.jpg" alt="1-7" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog007-2021-09-22/1-8.jpg" alt="1-8" /></p>
<blockquote>
<p>施工中</p>
</blockquote>
]]></content>
      <categories>
        <category>计算器</category>
      </categories>
      <tags>
        <tag>Vintage</tag>
        <tag>Hewlett-Packard</tag>
      </tags>
  </entry>
  <entry>
    <title>CORDIC算法的理解和Verilog实现</title>
    <url>/2022/01/19/blog008-2022-01-19/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog008-2022-01-19/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="0引子"><a class="markdownIt-Anchor" href="#0引子"></a> 0.引子</h2>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog008-2022-01-19/1-1.png" alt="1-1" /></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>r</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>α</mi><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>α</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>r</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo>+</mo><mi>α</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>α</mi><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>α</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x&#x27;=rcos(\theta+\alpha)=r(cos\theta cos\alpha-sin\theta sin\alpha) \\
y&#x27;=rsin(\theta+\alpha)=r(sin\theta cos\alpha+cos\theta sin\alpha)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.996332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>α</mi><mo>=</mo><mfrac><mi>y</mi><mi>r</mi></mfrac><mo separator="true">,</mo><mtext> </mtext><mi>c</mi><mi>o</mi><mi>s</mi><mi>α</mi><mo>=</mo><mfrac><mi>x</mi><mi>r</mi></mfrac></mrow><annotation encoding="application/x-tex">sin\alpha=\frac{y}{r},~cos\alpha=\frac{x}{r}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mfrac><mi>x</mi><mi>r</mi></mfrac><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>−</mo><mfrac><mi>y</mi><mi>r</mi></mfrac><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>−</mo><mi>y</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mspace linebreak="newline"></mspace><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mfrac><mi>x</mi><mi>r</mi></mfrac><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>+</mo><mfrac><mi>y</mi><mi>r</mi></mfrac><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>+</mo><mi>y</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">x&#x27;=r(\frac{x}{r}cos\theta-\frac{y}{r}sin\theta)=xcos\theta-ysin\theta \\
y&#x27;=r(\frac{x}{r}sin\theta+\frac{y}{r}cos\theta) = xsin\theta+ycos\theta
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.996332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
x&#x27; \\
y&#x27; \\
\end{bmatrix}
=
\begin{bmatrix}
cos\theta &amp; -sin\theta \\
sin\theta &amp;  cos\theta \\
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<blockquote>
<p>施工中</p>
</blockquote>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>Verilog</tag>
      </tags>
  </entry>
  <entry>
    <title>【EE随笔-3】高线性度混频器ADL5350</title>
    <url>/2022/02/10/blog010-2022-02-10/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog010-2022-02-10/title.png" alt="title" /></p>
<span id="more"></span>
<h2 id="随笔"><a class="markdownIt-Anchor" href="#随笔"></a> 随笔</h2>
<p>好基友LingMao这两天在为新项目选型，提到了ADI的一款高线性度混频器<code>ADL5350</code>：</p>
<p><a href="https://www.analog.com/en/products/adl5350.html">https://www.analog.com/en/products/adl5350.html</a></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog010-2022-02-10/1-1.png" alt="1-1" /></p>
<p>并发现在ADI技术论坛上有这样一个回复，ADL5350的RF和IF在芯片内是连在一起的，这下在使用中，输出滤波器不仅需要对付混频后的镜像，还要对付下RF或者IF信号（因为ADL5350既可以用作上变频器，也可以用作下变频器）。在手册中，给出了ADL5350的原理说明，它是一种GaAs pHEMT （氮化镓赝调制掺杂异质结场效应晶体管）单端无源混频器，通过FET结沟道的导电性变化来调制RF信号：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog010-2022-02-10/1-2.png" alt="1-2" /></p>
<p>芯片外围需要不少LC网络。RF信号经过带通网络，抑制镜像并减弱宽带噪声。RF与IF在芯片内一同连接到时变负载上，这样RF信号就会受LO信号调制，并在IF端由带通网络抑制RF信号并选出混频信号。RF和IF端口应该是对称设计，并且可以互换。</p>
<p>此外ADL5350使用了FET作为混频核心，但属于无源混频器，这使我想起了之前在电赛训练器件，经常会有“不允许使用其他有源器件”的限制，当时就“二极管是不是有源器件”、“变压器是不是有源器件”展开过激烈的讨论（本质还是想钻空子整活）。混频器也有有源与无源之分，但我未作详细的了解。在看到ADL5350手册中“The ADL5350 is a GaAs pHEMT, single-ended, passive mixer with an integrated LO buffer amplifier.”中的Passive一词时，一时不知如何翻译。索性去查询了一下电学中Passive的含义：</p>
<p><a href="https://www.electrical4u.com/active-and-passive-elements-of-electrical-circuit/">https://www.electrical4u.com/active-and-passive-elements-of-electrical-circuit/</a></p>
<blockquote>
<p>A passive component is an electronic component which can only receive energy, which it can either dissipate, absorb or store it in an electric field or a magnetic field. Passive elements do not need any form of electrical power to operate.</p>
</blockquote>
<p>如此想来，混频核心需要使用电源的吉尔伯特型混频器、收音机里常用的单晶体管混频器等属于有源混频器；二极管混频器属于无源混频器。ADL5350的混频核心是时变负载，在工作时吸收RF或IF信号，因此属于无源混频器；同样，开关混频器也属于无源混频器。</p>
<p>其实我认为做有源与无源的区分不是重点，重点是了解各种混频器的性能和特点，比如混频增益与线性度等。</p>
<p>此外，在讨论中有群友提到：平衡混频器有一种用法，可以从IF口输入DC电流，RF的信号就会直接从LO出去，调电流就能调衰减。感觉是个值得研究的点。正巧我与LingMao在讨论衰减器与检波器配合完成较精准的电平控制的问题，衰减器的选型很是麻烦，不知这种混频器作为衰减器的用法能不能提供另一种可能。</p>
]]></content>
      <categories>
        <category>EE-随笔</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>【EE随笔-2】LMT4601 uModule</title>
    <url>/2021/09/19/blog005-2021-09-19/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="随笔"><a class="markdownIt-Anchor" href="#随笔"></a> 随笔</h2>
<p>今日在<s>海鲜市场</s><code>30包邮</code>提得两片带板凌力尔特<s>特供巧克力月饼</s>，参数看上去甚是生猛，更兼有远端检测和锁相环等花哨功能：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/2-1.png" alt="2-1" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/2-2.png" alt="2-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/1-1.jpg" alt="1-1" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/1-2.jpg" alt="1-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/1-3.jpg" alt="1-3" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/1-4.jpg" alt="1-4" /></p>
<p>也许能做一个超大输出电流精密电源吧。</p>
<p>至于PLL的功能，是将开关频率同步至外部的参考频率，以避免向系统中引入额外的谐波分量。在<strong>Linear</strong>的应用笔记中，也介绍过一种使用<code>D触发器</code>将开关频率与参考频率同步的方法：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog005-2021-09-19/3-1.png" alt="3-1" /></p>
]]></content>
      <categories>
        <category>EE-随笔</category>
      </categories>
      <tags>
        <tag>电源</tag>
      </tags>
  </entry>
  <entry>
    <title>振荡器资料收集</title>
    <url>/2022/04/06/blog012-2022-04-06/</url>
    <content><![CDATA[<p>平衡的艺术</p>
<span id="more"></span>
<h2 id="0资料收集"><a class="markdownIt-Anchor" href="#0资料收集"></a> 0.资料收集</h2>
<h3 id="01状态可变振荡器"><a class="markdownIt-Anchor" href="#01状态可变振荡器"></a> 0.1.状态可变振荡器</h3>
<ul>
<li>DIGITALLY PROGRAMMABLE, TIME-CONTINUOUS ACTIVE FILTER：<a href="https://www.ti.com.cn/cn/lit/an/sbfa005/sbfa005.pdf?ts=1648699984042&amp;ref_url=https%253A%252F%252Fwww.ti.com.cn%252Fproduct%252Fcn%252FUAF42">https://www.ti.com.cn/cn/lit/an/sbfa005/sbfa005.pdf?ts=1648699984042&amp;ref_url=https%3A%2F%2Fwww.ti.com.cn%2Fproduct%2Fcn%2FUAF42</a></li>
<li>FILTER DESIGN PROGRAM FOR THE UAF42 UNIVERSAL ACTIVE FILTER：<a href="https://www.ti.com.cn/cn/lit/an/sbfa002/sbfa002.pdf?ts=1648699989423&amp;ref_url=https%253A%252F%252Fwww.ti.com.cn%252Fproduct%252Fcn%252FUAF42">https://www.ti.com.cn/cn/lit/an/sbfa002/sbfa002.pdf?ts=1648699989423&amp;ref_url=https%3A%2F%2Fwww.ti.com.cn%2Fproduct%2Fcn%2FUAF42</a></li>
<li>Designing RC Oscillator Circuits with Low Voltage Operational Amplifiers and Comparators for Precision Sensor Applications：<a href="https://www.onsemi.com/pub/Collateral/AND8054-D.PDF">https://www.onsemi.com/pub/Collateral/AND8054-D.PDF</a></li>
<li>Designing Operational Amplifier Oscillator Circuits For Sensor Applications：<a href="https://ww1.microchip.com/downloads/en/Appnotes/00866a.pdf">https://ww1.microchip.com/downloads/en/Appnotes/00866a.pdf</a></li>
<li>Nice state variable oscillator：<a href="https://www.eevblog.com/forum/projects/nice-state-variable-oscillator/">https://www.eevblog.com/forum/projects/nice-state-variable-oscillator/</a></li>
<li>Developing a State Variable Oscillator for Audio Applications：<a href="http://www.williamsonic.com/AudioOsc/">http://www.williamsonic.com/AudioOsc/</a></li>
<li>Fast Amplitude Stabilization of an RC Oscillator：<a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1050492">https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1050492</a></li>
<li>STATE WARIABLE OSCELLATOR HAVING IMPROVED REJECTION OF LEVELER-INDUCED DISTORTION：<a href="https://patentimages.storage.googleapis.com/11/ff/9f/cce62d8c83fc0c/US4560958.pdf">https://patentimages.storage.googleapis.com/11/ff/9f/cce62d8c83fc0c/US4560958.pdf</a></li>
</ul>
<h3 id="02文氏桥振荡器等"><a class="markdownIt-Anchor" href="#02文氏桥振荡器等"></a> 0.2.文氏桥振荡器等</h3>
<ul>
<li>Sine Wave Oscillators：<a href="https://www.kennethkuhn.com/students/ee431/oscillators_sine_wave.pdf">https://www.kennethkuhn.com/students/ee431/oscillators_sine_wave.pdf</a></li>
<li>Using lamps for stabilizing oscillators：<a href="http://www.tronola.com/moorepage/Lamps.html">http://www.tronola.com/moorepage/Lamps.html</a></li>
<li>Wien Bridge Oscillator：<a href="https://stompville.co.uk/?p=872">https://stompville.co.uk/?p=872</a></li>
<li>Oscillators：<a href="http://jewel.buet.ac.bd/Electronics/Oscillators.pdf">http://jewel.buet.ac.bd/Electronics/Oscillators.pdf</a></li>
<li>Oscillator Circuits：<a href="https://sites.science.oregonstate.edu/~giebultt/COURSES/ph412/Reading/oscillators-1p.pdf">https://sites.science.oregonstate.edu/~giebultt/COURSES/ph412/Reading/oscillators-1p.pdf</a></li>
<li>Transistors Tutorial Part 7: “Oscillators”：<a href="http://www.learningelectronics.net/VA3AVR/tutorial/xtor/xtor7/xtor7.html">http://www.learningelectronics.net/VA3AVR/tutorial/xtor/xtor7/xtor7.html</a></li>
</ul>
<h3 id="03正交振荡器"><a class="markdownIt-Anchor" href="#03正交振荡器"></a> 0.3.正交振荡器</h3>
<ul>
<li>Quadrature Oscillator：<a href="https://freecircuitdiagram.com/979-quadrature-oscillator/">https://freecircuitdiagram.com/979-quadrature-oscillator/</a></li>
<li>Quadrature Oscillators Using Operational Amplifiers：<a href="https://www.hindawi.com/journals/apec/2011/320367/">https://www.hindawi.com/journals/apec/2011/320367/</a></li>
<li>Electronically Tunable Quadrature Sinusoidal Oscillator with Equal Output Amplitudes during Frequency Tuning Process：<a href="https://www.hindawi.com/journals/jece/2017/8575743/">https://www.hindawi.com/journals/jece/2017/8575743/</a></li>
</ul>
<h3 id="04数字振荡器"><a class="markdownIt-Anchor" href="#04数字振荡器"></a> 0.4.数字振荡器</h3>
<ul>
<li>A QUADRATURE OSCILLATOR：<a href="https://flylib.com/books/en/2.729.1/a_quadrature_oscillator.html">https://flylib.com/books/en/2.729.1/a_quadrature_oscillator.html</a></li>
<li>Digital Sine Oscillator Design：<a href="https://www.njohnson.co.uk/pdf/drdes/Chap7.pdf">https://www.njohnson.co.uk/pdf/drdes/Chap7.pdf</a></li>
<li>A New Recursive Quadrature Oscillator：<a href="https://www.vicanek.de/articles/QuadOsc.pdf">https://www.vicanek.de/articles/QuadOsc.pdf</a></li>
<li>How to implement a digital oscillator?：<a href="https://www.vicanek.de/articles/QuadOsc.pdf">https://www.vicanek.de/articles/QuadOsc.pdf</a></li>
<li>Digitally controlled oscillator for all-digital frequency locked loops：<a href="http://www.romjist.ro/full-texts/paper577.pdf">http://www.romjist.ro/full-texts/paper577.pdf</a></li>
</ul>
]]></content>
      <categories>
        <category>模拟电路</category>
      </categories>
      <tags>
        <tag>模拟</tag>
      </tags>
  </entry>
  <entry>
    <title>射频电路的自动增益控制</title>
    <url>/2022/01/12/blog009-2022-01-12/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog009-2022-01-12/title.png" alt="title" /></p>
<span id="more"></span>
<h2 id="0引子"><a class="markdownIt-Anchor" href="#0引子"></a> 0.引子</h2>
<h2 id="1自动增益控制电路"><a class="markdownIt-Anchor" href="#1自动增益控制电路"></a> 1.自动增益控制电路</h2>
<h3 id="11一些有用的链接"><a class="markdownIt-Anchor" href="#11一些有用的链接"></a> 1.1.一些有用的链接</h3>
<ul>
<li><a href="https://www.analog.com/media/en/training-seminars/tutorials/42575412022953450461111812375Design_and_Operation_of_AGC_Loops.pdf">DESIGN AND OPERATION OF AUTOMATIC GAIN CONTROL LOOPS FOR RECEIVERS IN MODERN COMMUNICATIONS SYSTEMS</a></li>
<li><a href="https://www.qsl.net/va3iul/Files/Automatic_Gain_Control.pdf">Automatic Gain Control (AGC) in Receivers</a></li>
<li><a href="https://www.analog.com/cn/app-notes/an-1040.html">AN-1040: RF功率校准提高无线发射机的性能</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/application-notes/AN-1507.pdf">AN-1507: Stable, Closed-Loop, Automatic Power Control for RF Applications</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/application-notes/AN-1527.pdf">AN-1527: Creating a Constant Envelope Signal Using the ADL5331 RFVGA and AD8319 Log Detector</a></li>
<li><a href="https://www.analog.com/cn/technical-articles/measurement-control-rf-power-partI.html">Measurement and Control of RF Power (Part I)</a></li>
<li><a href="https://www.analog.com/cn/technical-articles/measurement-control-rf-power-partII.html">Measurement and Control of RF Power (Part I)</a></li>
<li><a href="https://www.analog.com/cn/technical-articles/measurement-control-rf-power-partIII.html">Measurement and Control of RF Power (Part I)</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/AD8315.pdf">AD8315: 50 dB GSM PA Controller</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/AD8319.pdf">AD8319: 1 MHz to 10 GHz, 45 dB Log Detector/Controller</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/AD8307.pdf">AD8307: Low Cost, DC to 500 MHz, 92 dB Logarithmic Amplifier</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/hmc346ms8g.pdf">HMC346MS8G/346MS8GE: GaAs MMIC SMT VOLTAGE-VARIABLE ATTENUATOR, DC-8GHz</a></li>
<li><a href="https://www.analog.com/media/en/technical-documentation/application-notes/designing_with_the_hmc346ms8g_voltage_variable_attenuator.pdf">Designing With The HMC346MS8G Voltage Variable Attenuator</a></li>
</ul>
<h3 id="12各种地方出现的agc"><a class="markdownIt-Anchor" href="#12各种地方出现的agc"></a> 1.2.各种地方出现的AGC</h3>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog009-2022-01-12/1-2-1.png" alt="1-2-1" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog009-2022-01-12/1-2-2.png" alt="1-2-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog009-2022-01-12/1-2-3.png" alt="1-2-3" /></p>
<h2 id="2控制环路动态分析"><a class="markdownIt-Anchor" href="#2控制环路动态分析"></a> 2.控制环路动态分析</h2>
<p>此小节是对<code>AD8315</code>功放控制器（即对数放大器+误差放大器）数据手册中<code>CONTROL LOOP DYNAMICS</code>的翻译。</p>
<p>要想理解AD8315是如何在一个完整的控制环路中工作的，需要引入流过积分电容的电流的方程，这个方程由输入电压<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>N</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和设定电压<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>S</mi><mi>E</mi><mi>T</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{SET}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>确立：</p>
<p>首先，对数检波器累加得到的电流由输入决定：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><mi>D</mi><mi>E</mi><mi>T</mi></mrow></msub><mo>=</mo><msub><mi>I</mi><mrow><mi>S</mi><mi>L</mi><mi>P</mi></mrow></msub><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mo stretchy="false">(</mo><msub><mi>V</mi><mrow><mi>I</mi><mi>N</mi></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>V</mi><mi>Z</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I_{DET}=I_{SLP}log_{10}(V_{IN}/V_Z)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>其中：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><mi>D</mi><mi>E</mi><mi>T</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{DET}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是经过部分滤波后得到的解调信号，之后通过积分可得到信号精确的随机值。</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><mi>S</mi><mi>L</mi><mi>P</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{SLP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为电流斜率，每十倍<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>115</mn><mi>μ</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">115\mu A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">5</span><span class="mord mathdefault">μ</span><span class="mord mathdefault">A</span></span></span></span>（即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5.75</mn><mi>μ</mi><mi>A</mi><mi mathvariant="normal">/</mi><mi>d</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">5.75\mu A/dB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span><span class="mord mathdefault">μ</span><span class="mord mathdefault">A</span><span class="mord">/</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>）。</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>N</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为输入电压均方根值<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>r</mi><mi>m</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{rms}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">V_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为输入截断电压，其取决于输入波形，对于正弦波为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>316</mn><mi>μ</mi><msub><mi>V</mi><mrow><mi>r</mi><mi>m</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">316\mu V_{rms}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">6</span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mn>70</mn><mi>d</mi><mi>B</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">-70dBV</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">7</span><span class="mord">0</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span>）。</p>
<blockquote>
<p>施工中</p>
</blockquote>
]]></content>
      <categories>
        <category>射频电路</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>定向耦合器与定向电桥</title>
    <url>/2021/09/16/blog004-2021-09-16/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/title.png" alt="title" /></p>
<span id="more"></span>
<h2 id="0引子"><a class="markdownIt-Anchor" href="#0引子"></a> 0.引子</h2>
<p>近日在学习<a href="https://hforsten.com/">Henrik’s Blog</a>的<br />
<a href="https://hforsten.com/improved-homemade-vna.html">Improved homemade VNA</a>一文，其中介绍了定向电桥的制作方法，并给出了下面两个资料链接：</p>
<p><a href="http://www.ke5fx.com/Broadband_Coupler_Dunsmore.pdf">http://www.ke5fx.com/Broadband_Coupler_Dunsmore.pdf</a></p>
<p><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7345756">https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7345756</a></p>
<p>此前一直没有理解这种几个电阻构成的网络是如何实现定向耦合的效果，今天终于有了一个较为清晰的认识。</p>
<h2 id="1定向耦合器"><a class="markdownIt-Anchor" href="#1定向耦合器"></a> 1.定向耦合器</h2>
<p>在射频电路中，定向耦合器是非常重要的部件，用于功率分配和获取反射信号等。下图是<a href="https://blog.minicircuits.com/directional-couplers-their-operation-and-application/">Mini-Circuits的介绍文章</a>中给出的定向耦合器示意图：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-1.png" alt="1-1" /></p>
<p>信号由P1输入，P2输出，一小部分信号耦合至P3（耦合端口）输出，而极少有信号从P4（隔离端口）输出。这样一来，P3相当于从P1至P2方向的信号中“采样”了少许。这种配置的一个典型应用就是从FMCW雷达的功率输出端采样参考信号，用于和回波混频（图片来自<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ADF4158.pdf">ADF4158-DataSheet</a>）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-2.png" alt="1-2" /></p>
<p>回到上一张图片，若信号由P2射入P1，定向耦合器的特性会使得P3成为隔离端口，难以得到信号。不过，在由P2向P1耦合功率时，P1也向P2射有反射信号呢，可想而知，此时的反射波会在P3体现。这种配置常用于反射参数的测量（<a href="https://www.tek.com/document/poster/vector-network-analyzer-fundamentals">Vector Network Analyzer Fundamentals</a>）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-3.png" alt="1-3" /></p>
<p>在分布参数电路中，利用近场电磁波的特性可以设计出平行线定向耦合器（《射频/微波电路导论》，雷振亚，西安电子科技大学出版社，P80）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-4.jpg" alt="1-4" /></p>
<p>以及矩形波导定向耦合器（《简明微波》，梁昌洪，高等教育出版社，P237）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-5.jpg" alt="1-5" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/1-6.jpg" alt="1-6" /></p>
<p>这种定向耦合器损耗较小，一般工作在较高频率，缺点是低频下难以设计使用，而且带宽较小。若是在集中参数电路领域考虑，怎样的网络形式能实现类似定向耦合器的耦合与耦合特性呢？答案就是经典的<a href="https://en.wikipedia.org/wiki/Wheatstone_bridge">惠斯通电桥</a>。</p>
<h2 id="2定向电桥"><a class="markdownIt-Anchor" href="#2定向电桥"></a> 2.定向电桥</h2>
<p>在左侧是惠斯通电桥的基本形式：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/2-1.PNG" alt="2-1" /></p>
<p>如有</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>5</mn></msub></mfrac><mo>=</mo><mfrac><msub><mi>R</mi><mn>4</mn></msub><msub><mi>R</mi><mn>3</mn></msub></mfrac><mi mathvariant="normal">，</mi><mi mathvariant="normal">即</mi><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>3</mn></msub><mo>=</mo><msub><mi>R</mi><mn>4</mn></msub><msub><mi>R</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">\frac{R_1}{R_5}=\frac{R_4}{R_3}，即R_1R_3=R_4R_5
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">即</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>则电桥平衡。于是先保证此平衡状态，由公式可知只要确保电阻比例一致即可，那么同步调整左右两臂电阻，并由对角线的两个电阻处就能取得按比例分配的<strong>源电压</strong>。暂且认为由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">R_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">R_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>处取得电压（即从这两个电阻处引出接口）（电桥结构对称，选另一对电阻情况相同）。考虑端口阻抗匹配，令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>4</mn></msub><mo>=</mo><msub><mi>R</mi><mn>5</mn></msub><mo>=</mo><msub><mi>Z</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_4=R_5=Z_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，那么只要保证<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>3</mn></msub><mo>=</mo><msubsup><mi>Z</mi><mn>0</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">R_1R_3=Z_0^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span>，电桥可以保持平衡。在此前提下选择<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">R_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的比例，即可控制<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span>分给<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">V_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">V_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的比例，如右侧电路。</p>
<p>按照这样的分配思路，使<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">V_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>较大，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">V_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>较小，那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">V_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>处就可以作为传输端口<code>P2</code>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">V_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>处作为耦合端口<code>C</code>，引出端口，如下左图：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/2-2.png" alt="2-2" /></p>
<p>这样一来，耦合实现了，那么定向性是如何保证的呢？尝试将信号从传输端口<code>P2</code>接入，注意原<strong>输出电阻</strong>变为了信号源<strong>内阻</strong>，原<code>P1</code>处的源<strong>内阻</strong>现在作为<strong>输出电阻</strong>，如右侧电路。</p>
<p>此时输入处于一个“悬空”的状态，可能不太好分析，不如把地（零电位点）设为源处，因为电桥中所有端口的电压我们都是通过电位差定义的（差分输入/输出），所以地的位置无关紧要（方便分析即可）。接着，再把电路“扭转”一下：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/2-3.png" alt="2-3" /></p>
<p>太巧妙了，此时又形成了一个电桥，再细看，耦合端口恰好就处于平衡处！还记得之前我们设置的条件，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>3</mn></msub><mo>=</mo><msubsup><mi>Z</mi><mn>0</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">R_1R_3=Z_0^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span>，那么就在此刻惊天妙手，令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub><mo>=</mo><msub><mi>Z</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_2=Z_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，在上图的电桥中有:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>Z</mi><mn>0</mn></msub><msub><mi>R</mi><mn>3</mn></msub></mfrac><mo>=</mo><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>R</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{Z_0}{R_3}=\frac{R_1}{R_2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>电桥平衡，耦合端口输出为零！</p>
<p>如此一来，就由惠斯通电桥实现了定向耦合器，整理一下，如下图A所示：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog004-2021-09-16/2-4.png" alt="2-4" /></p>
<p>最后还有一个小问题，那就是输出端口<code>P2</code>是悬空的，那么就需要加入一个平衡转不平衡的变压器（巴伦）。图B即是最终的配置。这里使用了传输线变压器作为巴伦，优点是带宽较高（有空再来研究一下这个）。定向电桥就完成了。同样，它可以正向、反向使用，用于功率分配和测量反射等，如图B、C、D。</p>
<p>我认为，在保证线路阻抗一致性下，这种定向电桥的带宽主要取决于巴伦的性能，通常这个巴伦会使用一段同轴传输线外套数个高频磁环制成，工作带宽在100kHz至10GHz左右（<a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7345756">A 300kHz-13.5GHz Directional Bridge</a>）。</p>
<h2 id="3总结"><a class="markdownIt-Anchor" href="#3总结"></a> 3.总结</h2>
<p>有空实际做一个试试吧。</p>
]]></content>
      <categories>
        <category>射频电路</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>ADF4350模块设计笔记</title>
    <url>/2022/03/27/blog011-2022-03-27/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/title.jpg" alt="title" /></p>
<span id="more"></span>
<p>换到<strong>KiCad6.0</strong>后画的第一块板子，为白菜价的ADF4350做一个小模块，主要还是作验证之用，方便之后开发体积更小、功能更专一的模组（比如专门输出2.2-4.4GHz的纯正弦波）。</p>
<p>新Ki的改动不小，感觉整个操作逻辑在向鼠标偏移，而且少了我前最喜欢的<code>C</code>热键，还是有些不快的。不过弧形线和从选择的轮廓生成区域的功能非常方便，插件管理也更优秀了。</p>
<h2 id="0资料汇总"><a class="markdownIt-Anchor" href="#0资料汇总"></a> 0.资料汇总</h2>
<p>ADF4350与ADF4351相差不大，所以设计时参考了二者的相关资料。此外，ADF4350的数据手册似乎有些小错，于是又去查阅的ADF4351数据手册相同部分的内容。</p>
<ul>
<li>ADF4350锁相环数据手册：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ADF4350.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/ADF4350.pdf</a></li>
<li>EVAL-ADF4350EB2Z评估板手册：<a href="https://www.analog.com/media/en/technical-documentation/user-guides/UG-110.pdf">https://www.analog.com/media/en/technical-documentation/user-guides/UG-110.pdf</a></li>
<li>ADF4351锁相环数据手册：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ADF4351.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/ADF4351.pdf</a></li>
<li>EVAL-ADF4350EB2Z评估板手册：<a href="https://www.analog.com/media/cn/technical-documentation/user-guides/UG-435.pdf">https://www.analog.com/media/cn/technical-documentation/user-guides/UG-435.pdf</a></li>
<li>ADP3334低压差稳压器数据手册：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ADP3334.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/ADP3334.pdf</a></li>
<li>HMC284射频单刀双掷开关数据手册：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/hmc284a.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/hmc284a.pdf</a></li>
</ul>
<h2 id="1设计要点"><a class="markdownIt-Anchor" href="#1设计要点"></a> 1.设计要点</h2>
<h3 id="11杂七杂八"><a class="markdownIt-Anchor" href="#11杂七杂八"></a> 1.1.杂七杂八</h3>
<ul>
<li>ADF4350的框图，没啥用，暂且放在这里。<br />
<img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/1-1.png" alt="1-1" /></li>
<li>极限参数中，供点耐受范围基本是-0.3V至+3.9V，看来不需要提供5V级别的供电。</li>
<li>电流需求方面，数字与模拟部分合21mA，输出级6至24mA，VCO 70mA，低功耗模式下全片7至1000uA。VCO部分的电流需求还是较大的，在使用HMC860、HMC1060这种多路LDO的时候需要注意合理分配。</li>
<li>参考时钟输入允许小于10MHz的信号，但要保证压摆率大于21V/us，在使用某些正弦输出的振荡器时要注意处理。</li>
</ul>
<h3 id="12输出级设计"><a class="markdownIt-Anchor" href="#12输出级设计"></a> 1.2.输出级设计</h3>
<p>ADF4350的输出级类似集电极开路的长尾差分对，需要接入输出负载才可工作。根据使用场景，可分为有耗宽带输出匹配和窄带无耗输出匹配。同时，若有单端的输出需求，还可选择使用宽带巴伦或是窄带巴伦。</p>
<p>这些选择决定了正常输出的频率范围以及输出功率，在将ADF4350作为本振等用途时，这些参数至关重要，需要仔细考量。下面这部分是对ADF4350手册中27页往后<code>OUTPUT MATCHING</code>部分给出的接法：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/1-2.png" alt="1-2" /></p>
<p>使用电阻匹配为宽带匹配；使用电感作为负载，为窄带匹配，但此时输出功率得以增强，可达到5dBm。电感匹配差分输出的元件参数选择如下：</p>
<table>
<thead>
<tr>
<th>Frequency Range (MHz)</th>
<th>L (nH)</th>
<th>C (nF)</th>
</tr>
</thead>
<tbody>
<tr>
<td>137.5 to 500</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>500 to 1000</td>
<td>47</td>
<td>1</td>
</tr>
<tr>
<td>1000 to 2000</td>
<td>7.5</td>
<td>1</td>
</tr>
<tr>
<td>2000 to 4400</td>
<td>3.9</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>如果需要单端输出，可直接将差分输出的一个端口接匹配负载，使用另一个端口。这样相当于浪费了一个端口的功率。如果使用巴伦转换，则理想情况可以将两个端口的功率合路输出。ADF4350的手册中给出了一个使用无耗元件搭建窄带巴伦的示意，如上图的<code>Figure 39</code>。所需元件参数选择如下：</p>
<table>
<thead>
<tr>
<th>Frequency Range (MHz)</th>
<th>Inductor L1 (nH)</th>
<th>Capacitor C1 (pF)</th>
<th>RF Choke Inductor (nH)</th>
<th>DC Blocking Capacitor (pF)</th>
<th>Measured Output Power (dBm)</th>
</tr>
</thead>
<tbody>
<tr>
<td>137 to 300</td>
<td>100</td>
<td>10</td>
<td>390</td>
<td>1000</td>
<td>9</td>
</tr>
<tr>
<td>300 to 460</td>
<td>51</td>
<td>5.6</td>
<td>180</td>
<td>120</td>
<td>10</td>
</tr>
<tr>
<td>400 to 600</td>
<td>30</td>
<td>5.6</td>
<td>120</td>
<td>120</td>
<td>10</td>
</tr>
<tr>
<td>600 to 900</td>
<td>18</td>
<td>4</td>
<td>68</td>
<td>120</td>
<td>10</td>
</tr>
<tr>
<td>860 to 1240</td>
<td>12</td>
<td>2.2</td>
<td>39</td>
<td>10</td>
<td>9</td>
</tr>
<tr>
<td>1200 to 1600</td>
<td>5.6</td>
<td>1.2</td>
<td>15</td>
<td>10</td>
<td>9</td>
</tr>
<tr>
<td>1600 to 3600</td>
<td>3.3</td>
<td>0.7</td>
<td>10</td>
<td>10</td>
<td>8</td>
</tr>
<tr>
<td>2800 to 3800</td>
<td>2.2</td>
<td>0.5</td>
<td>10</td>
<td>10</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>从输出功率的数据看，巴伦起到了输出合路的功能，例如将两个无耗输出匹配时单端口输出的最大功率5dBm合路为10dBm。这种分立式巴伦应该是通过将两个输出端口的信号移相再合成实现的，工作带宽较窄。</p>
<p>如果使用变压器巴伦，则带宽可以大大拓宽，例如著名的<code>TCM1-63AX+</code>：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/1-3.png" alt="1-3" /></p>
<p>作为测试的第一版，我决定依然采用无耗匹配，差分输出，之后在外部测试一下使用变压器巴伦的效果。此外，变压器巴伦有电流型、电压型之分，有直流接法和隔直接法之分，有待研究，先将部分资料记录在此：</p>
<ul>
<li>Current vs. Voltage Baluns: <a href="https://www.markimicrowave.com/blog/current-vs-voltage-baluns">https://www.markimicrowave.com/blog/current-vs-voltage-baluns</a></li>
<li>Baluns: What They Do And How They Do lt: <a href="https://www.eznec.com/Amateur/Articles/Baluns.pdf">https://www.eznec.com/Amateur/Articles/Baluns.pdf</a></li>
<li>RF Transformer TCM1-63AX+: <a href="https://www.minicircuits.com/pdfs/TCM1-63AX+.pdf">https://www.minicircuits.com/pdfs/TCM1-63AX+.pdf</a></li>
<li>RF 1:1 Transmission Line ETC1-1-13: <a href="https://cdn.macom.com/datasheets/ETC1-1-13.pdf">https://cdn.macom.com/datasheets/ETC1-1-13.pdf</a></li>
</ul>
<p>对于备用输出端口B，不使用的时候可空置。最终输出级的设计如下图：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/1-4.png" alt="1-4" /></p>
<h3 id="13参考输入设计"><a class="markdownIt-Anchor" href="#13参考输入设计"></a> 1.3.参考输入设计</h3>
<p>参考输入端基本照抄了评估板的设计。由于想加一个外部输入的选择，又不想用跳线（排针太高）和开关（太奇怪），毕竟有可能要把参考时钟给到100MHz，所以上了一片射频SPDT，然后为了方便控制，又上了个sot23封装的双非门处理逻辑，再上了个拨码开关控制非门输入，简直就是简直了。这么麻烦主要还是因为我想把通信接口往<code>PMOD</code>上靠，而<code>PMOD</code>定义给出的8根数据线实在不够呀。</p>
<p>最终参考输入的设计如下图：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/1-5.png" alt="1-5" /></p>
<h2 id="2原理图及pcb设计"><a class="markdownIt-Anchor" href="#2原理图及pcb设计"></a> 2.原理图及PCB设计</h2>
<p>基本上是照抄ADF4350的评估板，稳压器采用了ADP3334，虽说感觉LT1763更合适。这二者都号称对输出电容很宽容，但上次调LT1763给我振了个爽，不知道这次用ADP3334会不会翻车。其实最理想的选择也许是HMC860，专为RF电路设计，QFN封装也更小。但HMC860的输出电流实在是太小了，对于ADF4350的几组供电来说捉襟见肘，还是下一版再考虑吧。</p>
<p>环路滤波器和射频输出部分的布局参考了ADF4351评估板。这ADF4350和ADF4351芯片差别不大，评估板的差别倒是挺大的，不知道是不是同一组开发的。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/2-1.png" alt="2-1" /></p>
<p>最后是完工的PCB设计样貌：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/2-2.png" alt="2-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/2-3.png" alt="2-3" /></p>
<h2 id="3上料焊接"><a class="markdownIt-Anchor" href="#3上料焊接"></a> 3.上料焊接</h2>
<p>3月27日在嘉立创投板，4月1日拿到：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog011-2022-03-27/3-1.jpg" alt="3-1" /></p>
<blockquote>
<p>配BOM，未完待续</p>
</blockquote>
<h2 id="4驱动程序设计"><a class="markdownIt-Anchor" href="#4驱动程序设计"></a> 4.驱动程序设计</h2>
<h2 id="5测试"><a class="markdownIt-Anchor" href="#5测试"></a> 5.测试</h2>
]]></content>
      <categories>
        <category>射频电路</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>图像抖动及其应用</title>
    <url>/2022/04/24/blog013-2022-04-24/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/title.jpg" alt="title" /></p>
<span id="more"></span>
<blockquote>
<p>这是<strong>CNPP</strong>的《数字图像分析》课程大作业的文稿。</p>
</blockquote>
<h2 id="1抖动简介"><a class="markdownIt-Anchor" href="#1抖动简介"></a> 1.抖动简介</h2>
<p>在计算机以及数字信号处理技术发展，有限的数据位宽带来了量化误差，在相当一段时间内制约着数字系统的精度以及效果。而抖动（Dither）则是一种对信号人为加入噪声，以使量化误差随机化的手段，以避免大片不自然的信号出现。</p>
<blockquote>
<p>最早对抖动的应用可追溯至第二次世界大战。当时，轰炸机使用装有成百上千齿轮的机械计算机进行导航和弹道计算。事实证明这些仪器在空中比在地面上表现得更为准确。工程师意识到这是因为飞机的振动使得哪些传动部件由短促的抽动变为了更加连续的运动，从而减小了行程的误差。于是他们特地在计算机中安装了振动电机以提高精度，同时，这种振动手段也被称为“dither”——源于中世纪英语动词“didderen”。如今，当你敲动机械仪表想让它指示得更准确时，其实就是在利用抖动。在现代的词典中，“dither”被定义为紧张、混乱或激动的状态，不过在此处，它是件使数字系统更接近模拟现实的好事。</p>
<p>— Ken Pohlmann, Principles of Digital Audio <a href="#5.%E5%8F%82%E8%80%83">[1]</a></p>
<blockquote>
<p>下图：诺顿光学轰炸瞄准具，以及其装备于投掷“小男孩”原子弹的伊诺拉·盖伊号B-29轰炸机。<br />
<img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/1-1.jpeg" alt="1-1" /><br />
<img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/1-2.jpeg" alt="1-2" /></p>
</blockquote>
</blockquote>
<p>此后，抖动技术应用于了数字音视频、地震信号处理、天气预报等诸多领域。</p>
<p>抖动技术的理论依据在于，量化过程产生的误差大多相关于原信号，这就会使得误差具有周期性或可预测性。在很多领域，周期性噪声会带来明显的不良影响。例如，人耳具有类似傅里叶变换的分辨能力，当音频中存在周期性误差时，就相当于额外增加了一个频率的声音，倍明显感觉。若使用抖动将这一误差随机化，其就难以倍人耳分辨<a href="#5.%E5%8F%82%E8%80%83">[2]</a> <a href="#5.%E5%8F%82%E8%80%83">[3]</a> <a href="#5.%E5%8F%82%E8%80%83">[4]</a>。</p>
<h2 id="2图像抖动的发展"><a class="markdownIt-Anchor" href="#2图像抖动的发展"></a> 2.图像抖动的发展</h2>
<p>人类对美的追求一向挑剔，对图像显示技术的诉求亦孜孜不倦。然而，存储一幅绚丽的图像的代价是难以想象的。以常见的1024*768分辨率大小的屏幕为例，显示RGB565格式的彩色信号，则一帧所占用的存储空间计算如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>1024</mn><mo>×</mo><mn>768</mn><mo>×</mo><mn>16</mn><mi>b</mi><mi>i</mi><mi>t</mi></mrow><mn>8</mn></mfrac><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>572</mn><mo separator="true">,</mo><mn>864</mn><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">\frac{1024\times768\times16bit}{8}=1,572,864Byte
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">7</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span></span></span></span></span></p>
<p>而对于早期的家用计算机，内存资源十分紧张（几十kByte左右），同时，当时的视频芯片通常没有独立的显存，需要与系统内存共用，这就决定了当时的计算机无法使用非常丰富的色彩。在那时，诞生出了颜色单元法（Color Cells）、NTSC伪色法（NTSC Artifact Coloring）、CPU驱动图形法（CPU Driven Graphics）等在较弱硬件机能下显示尽可能多色彩的方法。</p>
<blockquote>
<p>GBA掌机的屏幕可以显示15bit色彩（32768色），但限于存储空间，在每一块特定大小的区域中不会有太多颜色出现。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-1.jpg" alt="2-1" /></p>
</blockquote>
<p>在这样的条件下，抖动技术被广泛使用，来在各阶色彩间产生平滑过渡，或是当作灰度来使用。</p>
<blockquote>
<p>PC98，《玛丽亚的民谣》，使用规则抖动（Ordered dithering）实现天空的灰度渐变</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-2.png" alt="2-2" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-3.png" alt="2-3" /></p>
<p>PC98，《大航海时代2》，使用规则抖动在色彩间平滑过渡</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-4.png" alt="2-4" /></p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-5.png" alt="2-5" /></p>
<p>使用了相同的色彩，效果却截然不同，左侧：直接量化；右侧：Floyd–Steinberg抖动</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-6.png" alt="2-6" /></p>
<p>PS1，《寂静岭》，使用了硬件进行规则抖动</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-7.jpg" alt="2-7" /></p>
</blockquote>
<p>随着硬件性能的逐渐提升，显示器可以显示更多的色彩，电脑存储器也拥有了更大的空间，抖动技术便已不再必要。不过，在现在的许多便携设备上，显示器件、容量与功耗依然是分寸必争，图像抖动依然有广泛的用武之处。</p>
<p>例如下图所示的夏普LS032型MemoryLCD屏幕，是目前较为先进的一种低功耗LCD显示器件。其拥有分辨率高，像素密度高，刷新速度块，静态功耗极低，对比度强等特点。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-8.jpg" alt="2-8" /></p>
<p>美中不足的是，它只能显示黑白二值的像素，不具备灰度功能，但若能合理运用图像抖动，便也能取得不错的显示效果。这也是接下来抖动算法实践的实用目标。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/2-9.jpg" alt="2-9" /></p>
<h2 id="3图像抖动算法"><a class="markdownIt-Anchor" href="#3图像抖动算法"></a> 3.图像抖动算法</h2>
<p>根据维基百科的介绍，图像抖动主要有阈值抖动、随机抖动、规则抖动、Floyd–Steinberg抖动等<a href="#5.%E5%8F%82%E8%80%83">[5]</a>：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-1.png" alt="3-1" /></p>
<p>其中，阈值抖动是最简单的抖动算法，它是将每一个像素的灰度与一个固定的值比较得来的，与图像二值化相似，同时，也丢失了大量的细节；随机抖动则是与一个随机的阈值进行比较，这也是最初“抖动”的思路。图中的半调抖动与Bayer抖动同属于规则抖动，其使用以某种规则变化的二值矩阵代替原图中的灰度像素，前者依然应用于印刷业，后者则常见于古董计算机及老游戏。Floyd–Steinberg抖动是一种基于误差扩散思想的算法，有着很好的效果，并衍生出了数种从速度或锐度角度优化的算法。此次主要探究的是Bayer抖动算法和Floyd–Steinberg抖动算法。</p>
<h3 id="31bayer抖动"><a class="markdownIt-Anchor" href="#31bayer抖动"></a> 3.1.Bayer抖动</h3>
<p>Bayer抖动需要先从狭义的规则抖动说起，它的原理十分简单：假若只有黑白两种颜色可供使用，那要是想得到灰度效果，就用一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N{\times}N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord"><span class="mord">×</span></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>的二值矩阵来替代原来的灰度像素，根据原灰度数据调整矩阵中“0”、“1”的数量占比，这样组合之后，从宏观上观察便能体现出模拟灰度的效果。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-2.png" alt="3-2" /></p>
<p>这一过程的本质是用空间换取色彩深度，利用人眼的的空间低通滤波效果来模仿灰度，提升显示效果，这一原理颇有电学中“脉宽调制”的意味。</p>
<p>在这样的规则抖动算法中，仿色矩阵中色块的排布方式对最终效果有着重要影响，显而易见，矩阵中的色块应尽量分布均匀，而不是集中在一起（联想：脉宽调制、改进脉宽调制及Sigma-Delta调制）。一种简单巧妙的分散方法如上图右侧一列所示：对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2{\times}2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord"><span class="mord">×</span></span><span class="mord">2</span></span></span></span>仿色矩阵，灰度由低到高，先填充对角块，再填充剩下的块，使用矩阵描述即是：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M_1=
\begin{bmatrix}
    0 &amp; 2 \\
    3 &amp; 1 \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p>可见<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2{\times}2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord"><span class="mord">×</span></span><span class="mord">2</span></span></span></span>即2阶仿色矩阵，可模仿5级灰度，那么，要是想模拟跟多级灰度，仿色矩阵该如何得到呢？还是按照对角线先行的思路，递推可得：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>12</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>14</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>11</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>15</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>13</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M_2=
\begin{bmatrix}
    0  &amp; 8  &amp; 2  &amp; 10 \\
    12 &amp; 4  &amp; 14 &amp; 6  \\
    3  &amp; 11 &amp; 1  &amp; 9  \\
    15 &amp; 7  &amp; 13 &amp; 5  \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.80204em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.80499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.40599em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.65201em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">2</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">4</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span></span></span><span style="top:-1.2099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.80499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.40599em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.65201em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>可以得出递推公式：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><msub><mi>M</mi><mi>n</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><msub><mi>M</mi><mi>n</mi></msub><mo>+</mo><mn>2</mn><msub><mi>U</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><msub><mi>M</mi><mi>n</mi></msub><mo>+</mo><mn>3</mn><msub><mi>U</mi><mi>n</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><msub><mi>M</mi><mi>n</mi></msub><mo>+</mo><msub><mi>U</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M_{n+1}=
\begin{bmatrix}
    4M_n        &amp; 4M_n + 2U_n \\
    4M_n + 3U_n &amp; 4M_n +  U_n \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>即8阶仿色矩阵实用较多，被称为Bayer矩阵，Bayer抖动算法由此而来。</p>
<p>下图是一组<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>规则抖动的效果<a href="#5.%E5%8F%82%E8%80%83">[6]</a>，可以看出像素分布变化具有明显的规律，若原图像存在大片灰度相同或相近的区域，仿色图案也会在此重复排布，形成明显的线条感，对观感有很大的影响，这也是规则抖动的缺陷。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-3.png" alt="3-3" /></p>
<p>可见，人眼也对周期重复的图案十分敏感，和耳朵一样具有“傅里叶变换”的特性呢。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-4.png" alt="3-4" /></p>
<p>不过，得益于规则抖动较为简单的算法（以比较运算为主），且可针对单一像素使用，其运行速度很快。下面是在一块128*64像素的OLED显示屏上，使用Bayer抖动算法显示热成像传感器输出的8*8像素（灰度）热力图的效果：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-5.jpg" alt="3-5" /></p>
<p>全系统由一片48MHz的Cortex-M0微控制器实现，热力图流帧数可达20以上，显示效果很好。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-6.jpg" alt="3-6" /></p>
<h3 id="32floydsteinberg抖动"><a class="markdownIt-Anchor" href="#32floydsteinberg抖动"></a> 3.2.Floyd–Steinberg抖动</h3>
<p>Floyd–Steinberg抖动算法是一种误差扩散算法：先将处理的第一个像素点与阈值比较，得到量化后的像素值，将原像素值与量化像素值相减，得到量化误差，将这个误差按照一定比例加到周围的像素点上，再进行下一个像素点的比较、量化，重复执行。Floyd–Steinberg抖动算法使用的误差扩散权重如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>∗</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>7</mn><mn>16</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>3</mn><mn>16</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>5</mn><mn>16</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>16</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
        &amp;              &amp; *            &amp; \frac{7}{16} &amp; ...  \\
    ... &amp; \frac{3}{16} &amp; \frac{5}{16} &amp; \frac{1}{16}  &amp; ... \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.410216em;vertical-align:-0.9551080000000003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4551079999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551080000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4551079999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551080000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4551079999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∗</span></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551080000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4551079999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551080000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4551079999999998em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551080000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p>如同滴入清水中的墨汁的扩散，每个像素点的量化误差实际会扩散至其后的所有像素，最终，体现出一种较为自然的平滑效果。算法的实现使用Matlab语言可以较为简洁，如下所示：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> y = <span class="number">1</span> : Y_SIZE - <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x = <span class="number">1</span> + <span class="number">1</span> : X_SIZE - <span class="number">1</span></span><br><span class="line">        oldRGB = double(ditherImg(y, x, :));</span><br><span class="line">        newRGB = <span class="built_in">round</span>(oldRGB .* (scale / <span class="number">255</span>)) .* (<span class="number">255</span> / scale);</span><br><span class="line">        ditherImg(y, x, :) = newRGB; </span><br><span class="line">        errRGB = double(oldRGB - newRGB);</span><br><span class="line">        ditherImg(y + <span class="number">0</span>, x + <span class="number">1</span>, :) = double(ditherImg(y + <span class="number">0</span>, x + <span class="number">1</span>, :)) + errRGB .* (<span class="number">7</span>/<span class="number">16.0</span>);</span><br><span class="line">        ditherImg(y + <span class="number">1</span>, x - <span class="number">1</span>, :) = double(ditherImg(y + <span class="number">1</span>, x - <span class="number">1</span>, :)) + errRGB .* (<span class="number">3</span>/<span class="number">16.0</span>);</span><br><span class="line">        ditherImg(y + <span class="number">1</span>, x + <span class="number">0</span>, :) = double(ditherImg(y + <span class="number">1</span>, x + <span class="number">0</span>, :)) + errRGB .* (<span class="number">5</span>/<span class="number">16.0</span>);</span><br><span class="line">        ditherImg(y + <span class="number">1</span>, x + <span class="number">1</span>, :) = double(ditherImg(y + <span class="number">1</span>, x + <span class="number">1</span>, :)) + errRGB .* (<span class="number">1</span>/<span class="number">16.0</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>使用灰度模式，2bit量化：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-7.png" alt="3-7" /></p>
<p>使用彩色模式，2bit量化：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-8.jpg" alt="3-8" /></p>
<p>使用彩色度模式，4bit量化，在PC98时期，很多游戏都采用了16级色彩，即4bit，左图直接量化的效果可以说是稍有“PC98风了”，若如右图应用Floyd–Steinberg抖动，画面效果的提升还是明显的。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-9.png" alt="3-9" /></p>
<p>Floyd–Steinberg抖动不会产生连续规则的条纹，不需要牺牲像素点数，平滑效果良好，可以说是十分出色的抖动算法。不过，误差扩散原理也意味着，一个像素点的改变会带来其他大量像素点的重新计算，在处理视频时代价巨大，且算法中包含大量乘加。因此，Floyd–Steinberg抖动并没像规则抖动那样应用广泛。</p>
<p>同时可以注意到，Floyd–Steinberg抖动会带来许多离散的点，即使在原图的大片空白处也会出现，且呈现出规律排布，这也是误差扩散带来的特性，在图像分辨率较低时，可能对观感有较大的影响：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-10.png" alt="3-10" /></p>
<p>但它仍不失为一个巧妙而成功的算法。此后，又有许多学者基于Floyd–Steinberg算法作出了改进，在显示效果及运行效率上进行优化<a href="#5.%E5%8F%82%E8%80%83">[5]</a>：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-11.png" alt="3-11" /></p>
<p>最后是在MemoryLCD上使用Floyd–Steinberg抖动实现的频谱显示效果：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-12.jpg" alt="3-12" /></p>
<p>以及利用误差扩散思想，仅在一维作扩散，得到的效果，使用此方法实现瀑布图显示预期会得到更好的效果：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/3-13.png" alt="3-13" /></p>
<h2 id="4总结"><a class="markdownIt-Anchor" href="#4总结"></a> 4.总结</h2>
<p>如今，随着软硬件技术的发展，屏幕、存储越来越难以阻止数字图像的绚烂，抖动技术也渐渐淡出了主流显示领域。但是在低功耗、便携设备的领域，它依然以各种方式，在有限的硬件机能下为我们提升观感。</p>
<p>此外，抖动算法依然活跃于以像素风格为主题的美术、游戏作品之中，为复古的艺术带来和谐的视觉提升。</p>
<blockquote>
<p>拍一幅GameBoy风格的照片：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/4-1.png" alt="4-1" /></p>
<p>像素风格极短RPG解谜作品《噬人白昼》<a href="#5.%E5%8F%82%E8%80%83">[7]</a>：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog013-2022-04-24/4-2.png" alt="4-2" /></p>
</blockquote>
<h2 id="5参考"><a class="markdownIt-Anchor" href="#5参考"></a> 5.参考</h2>
<p>[1] Ken C. Pohlmann (2005). Principles of Digital Audio. McGraw-Hill Professional. ISBN 978-0-07-144156-8.<br />
[2] Deutsch, Diana (1999). The psychology of music. Gulf Professional Publishing. p. 153. ISBN 978-0-12-213565-1. Retrieved 24 May 2011.<br />
[3] Hauser, Marc D. (1998). The evolution of communication. MIT Press. p. 190. ISBN 978-0-262-58155-4. Retrieved 24 May 2011.<br />
[4] Montgomery, Christopher (Monty) (2012–2013). “Digital Show and Tell”. <a href="http://Xiph.Org">Xiph.Org</a> / Red Hat, Inc. Retrieved 27 February 2013. “Dither is specially-constructed noise that substitutes for the noise produced by simple quantization. Dither doesn’t drown out or mask quantization noise, it replaces it with noise characteristics of our choosing that aren’t influenced by the input.”<br />
[5] Wikipedia. Dither. <a href="https://en.wikipedia.org/wiki/Dither#cite_note-Deutsch1999-9">https://en.wikipedia.org/wiki/Dither#cite_note-Deutsch1999-9</a><br />
[6] Wikipedia. Ordered dithering. <a href="https://en.wikipedia.org/wiki/Ordered_dithering">https://en.wikipedia.org/wiki/Ordered_dithering</a><br />
[7] 《噬人白昼》. congwsbn. <a href="https://rpg.blue/?317370">https://rpg.blue/?317370</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>$$ $$</code></p>
]]></content>
      <categories>
        <category>课程设计</category>
      </categories>
      <tags>
        <tag>数字图像处理</tag>
      </tags>
  </entry>
  <entry>
    <title>经典双平衡混频器NE602</title>
    <url>/2022/05/12/blog014-2022-05-12/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog014-2022-05-12/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="0前言"><a class="markdownIt-Anchor" href="#0前言"></a> 0.前言</h2>
<p>在电子DIY领域，总有那么几款芯片被人津津乐道，拥有浩瀚的应用电路，甚至是许多人接触电子后第一个认识的芯片。比如有着“万能芯片”之称的<strong>555</strong>定时器，数模混合的特性使它拥有了无线可能，我制作的第一个电路就是一个基于<strong>555</strong>的方波、三角波和正弦波发生器；再之后，我又借着<strong>555</strong>，走上了开关电源之路，制作了高压电容充电器、等离子扬声器和无线充电器等视听与可玩性俱佳的小玩意</p>
<p>据说，自七十年代初到之后的很长一段时间，运放<strong>741</strong>是最为常运的放大器，现在在一些电子DIY网站上找到的很多老电路图中的运放都是这款。而对于零零后的我们，这一最常用运放的地位也许该让位给了<strong>358</strong>，它得益于宽供电范围，比较低的输入输出下轨，可适用于大多数供电场合。它稳定的性能也使得我现在遇到电路中疑似运放故障的问题时，依然会换上一片358进行交叉排除。</p>
<p>而今天所要说的，是射频领域的“万能芯片”：<strong>NE602</strong>双平衡混频器，也包括它的姊妹型号<strong>NE612</strong>、<strong>SA602</strong>、<strong>SA612</strong>。我第一次见到这颗芯片是在“蛙鸣”短波电台中，之后在矿石收音机论坛和各种业余无线电的DIY书籍中也频频见到它的身影，当然，这都是高中时（2018年左右）的记忆了。而最近当我拆开初版<strong>NanoVNA</strong>的屏蔽壳时，它依然在那里（不过是现在生产更多的型号<strong>SA612</strong>），在这台可以工作至900MHz的完备的掌上矢量网络分析仪中。</p>
<p>随着我对射频与无线电的兴趣一步步加深，脑海中也逐渐浮现了一些射频仪表、收发信机之类的设计灵感。在选型时，我想找一个1GHz以下，功耗尽可能低的混频器，发现竟鲜有相关的产品（<strong>ADI</strong>挺有名的AD831混频器功耗几乎有1W，正常工作时就已经能达到烫手的程度），在道路尽头等待我的，依旧是<strong>NE602</strong>系列，以及另一款在<strong>ICOM</strong>的手台中很常用的<strong>uPC2757</strong>。</p>
<p>也许这就是经典吧。真好最近我想尝试制作一个低成本的射频<strong>I-V</strong>法阻抗分析仪，并以<strong>SA612</strong>为主要混频器，于是一边写下此文，一边先行学习这颗经典芯片的使用方法。</p>
<h2 id="1资料收集"><a class="markdownIt-Anchor" href="#1资料收集"></a> 1.资料收集</h2>
<ul>
<li>SA612A Double-balanced mixer and oscillator product data sheet: <a href="https://www.nxp.com.cn/docs/en/data-sheet/SA612A.pdf">https://www.nxp.com.cn/docs/en/data-sheet/SA612A.pdf</a></li>
<li>AN1982 Applying the oscillator of the NE602 in low-power mixer applications: <a href="https://docs.rs-online.com/3cf1/0900766b80027aa2.pdf">https://docs.rs-online.com/3cf1/0900766b80027aa2.pdf</a></li>
<li>AN1983 Crystal oscillators and frequency multipliers using the NE602 and NE5212: <a href="https://web.stanford.edu/class/ee133/appnotes/AN1983.pdf">https://web.stanford.edu/class/ee133/appnotes/AN1983.pdf</a></li>
<li>PA1DSP - Why NOT to use the NE602: <a href="https://studyres.com/doc/7790754/pa1dsp---why-not-to-use-the-ne602?page=1">https://studyres.com/doc/7790754/pa1dsp---why-not-to-use-the-ne602?page=1</a></li>
<li>Modernization of QRP RADIOS and Development of the QCX transceiver: <a href="https://www.qrp-labs.com/images/news/dayton2018/seminar.pdf">https://www.qrp-labs.com/images/news/dayton2018/seminar.pdf</a></li>
<li>Single-chip frequency conventer: <a href="http://www.n5dux.com/ham/files/pdf/Single-Chip%20Frequency%20Converter.pdf">http://www.n5dux.com/ham/files/pdf/Single-Chip Frequency Converter.pdf</a></li>
<li>Using the NE602: <a href="http://www.lb3hc.net/wp-content/uploads/2019/12/UsingTheNe602.pdf">http://www.lb3hc.net/wp-content/uploads/2019/12/UsingTheNe602.pdf</a></li>
</ul>
<h2 id="2ne602介绍"><a class="markdownIt-Anchor" href="#2ne602介绍"></a> 2.NE602介绍</h2>
<p>NE602中集成了一个基于<strong>吉尔伯特单元</strong>的双平衡混频器、一部分震荡电路和一个电源单元。混频器的输入输出均为差分配置。NE602的结构框图和引脚分配如下图所示。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog014-2022-05-12/2-1.png" alt="2-1" /></p>
<p>这样的组合，使得NE602可以在一些选频网络的配合下，为自己提供一个本振，起到频率变换器的作用，直接围绕NE602做个直接变频收信/发信机很是容易。在NE602的手册中，介绍了几种振荡器的接法：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog014-2022-05-12/2-2.png" alt="2-2" /></p>
<p>实际上就是围绕NE602中的一个三极管组成考毕兹或者哈特莱这些三点式振荡器。此前我一直有个疑问，NE602是只能用这个振荡器作为本振吗，能不能使用外部提供的本振信号呢？其实看看更详细的内部等效电路就明了了：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog014-2022-05-12/2-3.png" alt="2-3" /></p>
<p>直接从<code>6</code>脚输入本振信号，就相当于旁路了振荡器的三极管，可以直接通过缓冲级驱动混频器了。</p>
<p>参数方面，从数据手册中摘取一些值得注意的如下：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>值</th>
<th>评论</th>
</tr>
</thead>
<tbody>
<tr>
<td>供电电压</td>
<td>4.5-8.0V</td>
<td>尚可，能适配5V系统</td>
</tr>
<tr>
<td>供电电流</td>
<td>2.4-3.0mA</td>
<td>真的相当小</td>
</tr>
<tr>
<td>输入频率</td>
<td>典型值500MHz</td>
<td>覆盖了业余无线电常用的短波及UV段</td>
</tr>
<tr>
<td>振荡器频率</td>
<td>典型值200MHz</td>
<td>我暂且用不上这个振荡器</td>
</tr>
<tr>
<td>噪声系数（45MHz下）</td>
<td>5.0dB</td>
<td></td>
</tr>
<tr>
<td>输入三阶交调点（条件略）</td>
<td>-13dBm</td>
<td>动态范围相当小，需要重视</td>
</tr>
<tr>
<td>射频输入阻抗</td>
<td>最小1.5k<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span></span></span></span></td>
<td>似乎是单端输入阻抗，需要注意</td>
</tr>
<tr>
<td>射频输入电容</td>
<td>3pF</td>
<td></td>
</tr>
<tr>
<td>混频器输出电阻</td>
<td>1.5k<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Ω</span></span></span></span></td>
<td>单端输出阻抗</td>
</tr>
</tbody>
</table>
<p>其中，输入三阶交调点需要特别注意。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog014-2022-05-12/2-4.png" alt="2-4" /></p>
<blockquote>
<p>未完待续···</p>
</blockquote>
]]></content>
      <categories>
        <category>射频电路</category>
      </categories>
      <tags>
        <tag>射频</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/04/14/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2>
<h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>【模拟之旅-1】供电与虚拟地发生器</title>
    <url>/2023/01/23/blog016-2023-01-23/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="0前言"><a class="markdownIt-Anchor" href="#0前言"></a> 0.前言</h2>
<p>最近半年呢，CNPP不知怎么回事，愈发迷上了模拟电路，还拾起了高中时做洞洞板电路的一套功夫，花个大半天就能做出一款，修修改改也很方便，可比打样爽快多了。</p>
<p>在这个过程中，CNPP探索了不少模电中，曾经未涉足过的新领域，比如非线性电路、模拟计算电路、低功耗电路和分立器件电路等，颇有一种步入桃花源般豁然开朗的快意。于是便想开启一个新的专题，名为【模拟之旅】，来和大家一起分享这一路上的奇观趣闻。</p>
<p>那么，我们旅程的起点是哪里呢，当然是CNPP的HomeLeb。没错，CNPP已经毕业啦，告别了实验室，告别了1G带宽的示波器，告别了8G的矢网，告别了26.5G的频谱仪，回到了只有口袋仪器可堪一用的小窝，可谓悲凉~~。没事，这些都可以克服！我们研究模电的，不需要高端大气的仪器，20M的带宽，就够我们用了！但这其中最大的困难，还是电源————家里没有双路输出的实验电源呀。</p>
<p>CNPP身边呢，一直有这样一台电源：<strong>菊水PMC18-1A</strong>，它的输出电压范围与常见实验电源的30V、36V相去甚远，输出电流也可以用纤弱来形容，这也使得它在二手市场上几乎无人问津。但这样的参数，却几乎覆盖了CNPP三年来的电子DIY旅程，再加上10圈精密调节的电流档，超低的输出纹波和安静的性格，真的是爱不释手。</p>
<p><img src="blog016-2023-01-23/0-1.jpg" alt="0-1" /></p>
<p>可再怎么说，这也是一台单路输出的电源，而谈到模电，双电源几乎是扯不开的。CNPP想谈的解决方法就是今天的主题————<strong>虚拟地发生器</strong>，它能将单电源输入“转换”成双电源，从而可以使后面的电路可以全部使用标准的双电源设计方法。</p>
<p>其实在高中时，CNPP一直靠着两节18650锂电池来玩特斯拉线圈、等离子扬声器这种功率电路；在电源还没运到的前些日子，还在靠9V叠层电池和虚拟地发生器来研究模拟电路，所以说工具并不是咕咕咕的理由，<strong>摸鱼才是！！</strong>，这两天CNPP也是下定决心<s>少摸点</s>，来为大家更新【模拟之旅】。</p>
<h2 id="1模拟电路的电源"><a class="markdownIt-Anchor" href="#1模拟电路的电源"></a> 1.模拟电路的电源</h2>
<p>不知道大家有没有想过，模拟电路的“模拟”是什么意思呢？实际上，模拟信号(<a href="https://en.wikipedia.org/wiki/Analog_signal">Analog Signal</a>)指的是某种<strong>连续</strong>的，用来<strong>表示</strong>、<strong>模拟</strong>其他量的信号，比如说模拟音频信号，就是用连续的电压来表示声波幅度的连续变化。而“模拟电路”就是产生、处理模拟电信号的电路，其本质的目的是要解决电之外其他“量“的问题，对这些量进行记录、计算、生成、变换等。</p>
<p>在谈及电源之前，请容我再从一些更遥远的地方说起。我对模拟电路的一种理解是，它是数学工具的具象，是使用电子元器件，以数学运算的基础方式来解决我们生活中遇到的问题（因此我们的模电课本中会介绍放大器、加法器、减法器等电路）。在通俗的数学课本中，第一个要探讨的问题一般是参与运算的数字的范围，也就是数域。相似的，在我们的模拟之旅中，首先见到的，便是模拟电路的电源问题。</p>
<p>当结合了数学，模拟电路的电源是不是更容易理解了呢：有地，有正电源，有负电源，正如实数轴的原点、正半轴与负半轴一样。模拟电路正负电源的电压值可以任意设定，但在具体的实际应用中，是有限度的，<strong>就像是函数的定义域一样</strong>。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-01.jpg" alt="1-01" /></p>
<p>首要的是模拟电路的接地点，这是模拟电路对信号进行模拟计算的参考点；其次是正负电源供电，根据所处理信号电压值跨度的不同，可能需要正负双电源供电，也可能只需正或负单电源供电。</p>
<h3 id="11双电源"><a class="markdownIt-Anchor" href="#11双电源"></a> 1.1.双电源</h3>
<p>模拟电路最基础的配置就是双电源，以反向放大器为例，连接方法就如下图a中所示。一般来说，运算放大器的输出级是一个推挽结构，即由一个上晶体管负责将电流灌入负载，和一个下晶体管将电流从负载中吸出。如图b，如果将电源、接地点、运放输出级和负载电阻组成的回路单独提取出来看，可知负载电阻RL既可以获得正向的驱动电流，也可以获得反向的驱动电流；同时，负载电阻两端的电压也可以是正或者负。也就是说，双电源配置可以使运放输出正、负信号（也可输入正、负信号，分析从略）。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-02.jpg" alt="1-02" /></p>
<p>所以，在模拟电路的设计、仿真中，最通常的做法就是使用双电源，并且会用图c的方式来表示（其中的电池符号也可换成独立的电压源符号）。而当我们实际连接电路时，就会采用图d的方法：找一台双通道的实验电源，将两个通道按正-负-正-负串联，将中间的连接点视为参考地，两端分别作为正、负端口，然后接入电路（这里的实验电源也可替换为两颗电池、两个隔离的电源模块等）。</p>
<p>双电源的概念十分简洁，通用性也更好，但硬件的连接是相对复杂的，成本也较高。倘若在一个模拟电路的应用中，输入信号全部为正信号，处理过程全部为正，输出信号也全部为正信号，那是否可以只用正半部分的电源呢？答案是肯定的，</p>
<h3 id="12单电源"><a class="markdownIt-Anchor" href="#12单电源"></a> 1.2.单电源</h3>
<p>同向比例放大器是常用的在正电压范围内使用的电路之一，如下图中a所示。同样，我们把它的电源、负载和输出级拿出来分析，可以发现，此时负载电阻上只能获得正向的电流，电阻两端的电压只能为正。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-03.jpg" alt="1-03" /></p>
<p>需要注意的是，如果负载不是纯阻性的，比如说是一个电容，那么其上是可能出现负的电流的。</p>
<p>再举两个单电源的例子。如下图中a所示的低端电流检测电路，如果已知需要检测的电流只会流入检流电阻到地（即正向），且在检流电阻上产生的电压大于运放的输入下轨，那么就可以采用一个单电源供电的同向比例放大器对检流电阻两端的电压进行放大。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-04.jpg" alt="1-04" /></p>
<p>如果想对一个正信号进行低通滤波，可采用图b所示的单电源Sallen-Key滤波器，因为在这个电路中，运放处理信号的过程全在正电源范围内。而如果想要在这里使用MFB滤波器，由于其中的运放处于反向工作状态，需要进行一定的改装。</p>
<h3 id="13虚拟双电源"><a class="markdownIt-Anchor" href="#13虚拟双电源"></a> 1.3.虚拟双电源</h3>
<p>在了解了通用的双电源电路和特殊情况下的单电源电路后，让我们来考虑这样一个问题：如果要处理的信号既有正，又有负，但此时可供使用的电源只有正电源，此时应该如何设计相应的电路呢？我们还是通过几个例子来了解：</p>
<p><strong>第一个例子：</strong></p>
<p>如果需要<strong>对一个交流信号进行放大，但并不关心直流偏置</strong>，那么就可以使用单电源放大器和输入、输出的<strong>交流耦合</strong>来实现。如下图a，这是一个经典的NPN三极管共射极放大电路，其中C1和Rb1、Rb2构成了高通滤波器，可以对输入信号起到隔直的作用，这样输入信号的直流偏置就不会影响到三极管的直流工作点了；输出电容C2将被三极管放大的信号交流耦合至下一级，同样去除了共射放大器带来的直流偏置。</p>
<p>再看中间起到放大作用的<strong>单电源</strong>电路：Rb1与Rb2将电源电压<strong>分压</strong>，为三极管提供了合适的<strong>正偏压</strong>。需要注意的是，我们并不希望三极管将这个正偏压放大太多，否则会超出电源轨，但同时又希望对交流分量有较大的放大作用，于是Re和Ce被接入了电路。Re起到了负反馈的作用，对于直流信号来说，它会大大降低放大器的增益；而对交流信号来说，Ce将Re交流短路，于是使得放大器对交流信号保持了较大的增益。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-05.jpg" alt="1-05" /></p>
<p>通过对这样一个经典的交流耦合共射极放大器的分析，我们可以得出单电源放大器的一些设计思路：<strong>使用交流耦合，提供偏置电压，降低直流增益，提高交流增益</strong>。顺着这个思路，我们再看上图的b，使用运放设计一个单电源交流耦合放大器：输入输出不在赘述；在运放的反馈中，电容C2的加入，使得放大器对与直流信号来说表现为跟随器，增益为1，对于交流信号来说，增益为（1 + Rf2/Rf1）。可以说，C2的引入是非常巧妙的，在接下来的电路中还有它的功劳。</p>
<p><strong>第二个例子：</strong></p>
<p>如果需要<strong>对输入信号进行操作，同时输出信号需要一定的偏置</strong>，同样可以采用<strong>加入正偏置</strong>的方法来使用正单电源放大器解决。比如为一个只能输入正电压的ADC设计一个前端电路，使其能采集交流信号，不考虑直流偏置，如下图a所示。我们采用了上个例子中提到的交流耦合单电源放大器，但此时的输出是需要带有直流偏置的，于是去除了运放输出的耦合电容。一般来说，将ADC输入端的直流偏置电压设为参考电压Vref的一半是最合适的，即需要采集的交流信号骑在0.5Vref上，于是将放大器输入的偏置分压电阻的电源由VCC改为Vref，并将阻值设为相同，这样在C2的帮助下，放大器的输出直流偏置可稳定在0.5Vref，而对输入交流信号的放大倍数依然为（1 + Rf2/Rf1）。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-06.jpg" alt="1-06" /></p>
<p>如果要为ADC设计一个有采集一定范围正、负信号，且包括直流的模拟前端，不作放大，也可以用加偏置的单电源放大器实现，如上图的b所示。不过此时的偏置不是用分压的方式加入的，而是用电阻加法器，以<strong>叠加定理</strong>的原理加入的。</p>
<p>以上两个例子都是需要处理双极性的信号，但处理过程都是单极性的，于是可以通过加入正偏置的方法，使用单电源电路完成。还有一类应用的情况则是，处理信号的过程需要如反相这样的变换极性的操作，此时的处理就有所区别。如下图a所示的MFB型低通滤波器，如果只需要处理正信号，并想单电源使用，直接如此连接是错误的，因为其中的运放工作在反向放大的状态，输出信号是需要低于正输入端的，而此时运放的电源负和正输入端都接地，便无法正常工作。在没有负电源为运放提供更低的电源轨时，只能通过将正输入端的电压抬高来实现。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-07.jpg" alt="1-07" /></p>
<p>解决方法如上图b，使用电阻分压为正输入端提供一个位于运放供电电压之间的电压，此时这个单电源低通滤波器就可以正常处理正的信号了。</p>
<p>通过以上的几个例子可以看出，在只有单电源的情况下，模拟电路的设计会变得复杂，各种<strong>单电源电路</strong>是根据使用的场景特殊设计的，通用性降低了，也不容易记忆。<strong>但我们也可以从这些单电源的电路中总结出一些规律，就是使用电阻分压的方法，为电路的一些关键点位提供一个位于正电源与地之间的一个稳定的直流电压，然后让信号和处理基于这个直流电压进行操作。如果结合电路分析中的参考零电位点是可以任意指定的这一观点，将这个位于正供电与地之间的稳定电压视为零电位，那么之后的电路是否就相当于是采用双电源供电的了呢？</strong></p>
<p><strong>也就是说，我们是否可以从单电源中间创造出一个稳定的电压，视为一个虚拟的地，而这之后的电路全部按照双电源的通用电路来设计呢？</strong></p>
<p>见下图a，我们已经知道这样连接的单电源反向放大器是无法正常工作的，但如果使用电阻从单电源中分压出一半的电源电压，如b，并以此电压作为参考点，设其为地，不但输入端口重新选择它作为地，输出端口也选择它作为地，这样中间的电路部分，便可完全采用双电源的电路进行设计。这便是<strong>虚拟双电源电路</strong>。（需要注意的是，这里的电源采用了“电池”这样一个可以<strong>悬浮供电</strong>的电源，以避免机壳这种“真实地”引发的问题，这点在后面也会提到）。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/1-08.jpg" alt="1-08" /></p>
<p>这样一个虚拟双电源听上去十分美好，因为我们可以采用统一的双电源模拟电路设计方法了。但这里的电阻分压是一个实用的虚拟地产生方案吗？不完全是。如果采用这种虚拟双电源的运放下一级要接入的是另一个放大器，由于放大器的输入阻抗一般较高，相当于运放接了一个阻抗较高的负载，输出电流很小，在这种情况下电阻分压式虚拟双电源是可以正常工作的。但如果运放需要驱动一个阻抗较低的负载，问题就来了，如上图c所示：</p>
<p>我们还是采用抽象出电源、虚拟地发生器、运放输出级和负载的分析方法，假设此时运放正向负载电阻灌入电流，再次分离出相关的元件和环路，我们可以发现，当负载电阻RL上的电流上升时，虚拟地的下分压电阻R上的电流也上升，其两端的电压VR会下降（因为此时定义的VR的方向与电流方向是相反的），进而就会导致运放的正供电VCC下降。如果分压电阻R取的越大，负载电阻RL越小，VCC的下降就会越明显，从而使运放的电源轨降低，处理信号的范围受到限制。</p>
<p>通过使用较小的分压电阻R可以改善这个问题，但带来的代价是运放的静态功耗增大，因为分压电阻是直接与电源并联的。因此我们需要思考，是否能有一个电路可以自动调节上下R的阻值，使其上的压降保持稳定，同时又能为负载提供足够的电流呢？</p>
<h2 id="2虚拟地发生器"><a class="markdownIt-Anchor" href="#2虚拟地发生器"></a> 2.虚拟地发生器</h2>
<p>由运放跟随器构成的虚拟地发生器可以解决上述的问题，如下图a所示。还是通过抽象分析可知，运放输出级的晶体管取代了分压电阻的作用，既可以输出足够的电流，也可以保证其两端压降的稳定，使得在虚拟地发生器之后的电路可以按照双电源的形式设计，并可以正常工作。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-01.jpg" alt="2-01" /></p>
<p>同时，也确实有基于此原理的虚拟地芯片销售，比如TI的“裂轨者”TLE2426：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-01-01.jpg" alt="2-01-01" /></p>
<p>虚拟地发生器更直观的作用如下图a所示，将0.5Vs视为虚拟地，则原Vs节点可视为正供电，原GND节点可视为负供电。但需要强调的是，<strong>虚拟地和原本的地有着本质上的不同，如果原本的地是由来自与整个系统机壳连接的非隔离电源，或是来自实验电源并且连接插座的接地点的，在连接示波器等仪器时需要特别注意，探头的地线应该夹在正真的地上，而不是虚拟地，否则就会将虚拟地对真实地短路</strong>。如下图b所示。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-02.jpg" alt="2-02" /></p>
<p>不过，这种专用芯片可能并不是那么好买，我们有必要了解如何自己设计虚拟地发生器。没错，这并不是一个跟随器那么简单。如下图a所示，如果我们仔细思考虚拟地发生器之后需要连接的电路，即按照双电源设计的电路，就会发现这里不仅会有等效的负载电阻R，还有大量的芯片去耦电容C。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-03.jpg" alt="2-03" /></p>
<p>当将这些负载抽象出来，如上图b，就可发现这颗作为虚拟地发生器的U1肩扛着多么重的负担：要驱动低阻抗、高容性的负载。“稳定性”这个词相信已经在各位的脑海中浮现了。没错，稳定地驱动高容性负载就是虚拟地发生器需要解决的最大问题。</p>
<h3 id="21运算放大器的稳定性"><a class="markdownIt-Anchor" href="#21运算放大器的稳定性"></a> 2.1.运算放大器的稳定性</h3>
<p>在分析运算放大器的稳定性时，需要将运放和反馈网络拆开看待，因为一旦因不稳定进入振荡状态，负反馈就不再存在了。下面的一系列图展示了对运损放大器的开环幅频特性和反馈网络的幅频特性进行分析的例子。</p>
<p>首先，运算放大器的开环输出电阻不再能被忽略，这里用Ro表示。随着频率的增加，运放的开环增益Ao会下降，运放自身带来的开环相移也会增大。开环输出的信号经过反馈网络输入到负输入端。如果此时的信号相移等于或超过了180°，且没有被衰减，那么就会同时满足振荡的<strong>相位条件</strong>和<strong>幅度条件</strong>，预期的负反馈就成为了正反馈，运放也就进入了不稳定的振荡状态。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-04.jpg" alt="2-04" /></p>
<p>如上图a，对于跟随器，反馈网络只有一个跨接的开环输出电阻R哦，它不会带来相移和衰减；对于图b的同向比例放大器，反馈网络是一个电阻分压电路，会带来衰减但不会带来相移，这就使得这个电路达到不稳定的幅度条件更难，因此<strong>高增益的比例放大电路会比单位增益的跟随电路更加稳定</strong>。这也是为什么很多运放不能接成跟随器工作，而另一些可以接成跟随器工作的运放也会在手册上特别标注“单位增益稳定”这一优势。</p>
<p>从上面的分析图c和d可以看出，运放输出连接的负载也是反馈网络的一部分，因此在运放驱动低阻抗、高容性的负载时，反馈网络带来的相移会相当大，此时运放就很容进入不稳定的状态。</p>
<p>为了设计一个能够稳定工作的虚拟地发生器，我们首先要了解运放的开环幅频特性。以LT1013运放为例，在手册的图表部分，可以找到如下的开环幅频特性图。先看左图，随着频率的升高，运放的开环增益由100dB以上逐渐下降，在频率达到1MHz左右时，开环增益降到了0dB，再往下，运放就无法再放大信号了。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-05.jpg" alt="2-05" /></p>
<p>而右图则是运放在±20dB增益附近幅频特性曲线的放大图，可以看出，随着频率的升高，LT1013开环增益下降的同时，带来的相移也在增加，并且可能超过180°。在这个图中，我们可以从两个角度来考察稳定性，如记号笔所标注（以5V，0V的曲线为例）。</p>
<p>其一如a处，当运放的增益下降到0dB时，查表知此时的频率约为600kHz，在600kHz频率处找相移，发现相移约为130°，此时尚未达到180°，也就是说，给反馈网络留下了50°的余量，这就是所谓的“相位裕度”。</p>
<p>其二如b处，当运放的相移达到180°后，查表知此时的频率约为2.5MHz，在此频率下找增益，可知在-10dB以下，于是可知，如果LT1013接成跟随器，当工作频率升高时，就算达到了不稳定的相位条件（相移180°），也无法达成幅度条件（此时增益为-10dB以下，对信号是衰减的），因此LT1013用作跟随器的稳定的，也就是单位增益稳定。注意这里仅仅是空载稳定，并不代表带载后也能稳定。</p>
<p>以上两个角度其实是等效的，只是第一种更便于求相位裕度，第二种更适合判断是否稳定。关于运放稳定性的更详细分析，可以查阅<a href="https://www.analog.com/cn/landing-pages/002/Analog-Circuit-compilation-yang.html">《新概念模拟电路》</a>第三册的Section 74、75以及ADI的<a href="https://www.analog.com/en/education/education-library/linear-circuit-design-handbook.html">Linear Circuit Design Handbook</a> Section 1-1 部分。</p>
<p>在下面的LTSpice中，对LT1013开环以及加上高容性负载时的幅频特性进行了仿真，需要注意的是很多仿真模型并不能很好地表现运放的开环输出电阻，故在这里手动加入。可以看出在加入有高容性负载组成的反馈网络之后。整个环路在频率达到约135kHz处相移就达到了180°，而此时的环路增益仍然有3.7dB，在闭环后一定会引起振荡。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-05-01.jpg" alt="2-05-01" /></p>
<p>因此，直接使用LT1013这类普通运放接为跟随器，并不能用作虚拟地发生器，它们存在严重的稳定性隐患。而有一类运放则针对高容性的负载进行了特殊设计，使得它们甚至具有稳定驱动任意大小的容性负载的能力，如LT1364：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-05-02.jpg" alt="2-05-02" /></p>
<p>通过阅读手册可知，LT1364在后级电路中加入了自适应调整的结构，即下图中Rc与Cc组成的负反馈网络。当LT1364在驱动高容性负载时，这部分电路会主动降低放大器的增益，破坏振荡形成的幅度条件，从而使运放能够稳定驱动高容性负载。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-05-03.jpg" alt="2-05-03" /></p>
<p>类似的结构在可以驱动高容性负载的AD817中也有出现，如下图的CF处。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-05-04.jpg" alt="2-05-04" /></p>
<p>使用这类<strong>带有高容性负载驱动能力且单位增益稳定</strong>的运放，接成跟随器的形式做为虚拟地发生器是很合适的。不过它们也具有选型限制和静态功耗较高的缺点。</p>
<h3 id="22普通运放用作虚拟地发生器"><a class="markdownIt-Anchor" href="#22普通运放用作虚拟地发生器"></a> 2.2.普通运放用作虚拟地发生器</h3>
<p>使用一些低成本的普通运放或超低功耗运放，是否能制作合适的虚拟地发生器呢？前文中提到的补偿方案也许能帮到我们。在ADI的应用手册<a href="https://www.analog.com/media/en/technical-documentation/application-notes/AN-257.pdf">AN-257</a>以及应用问答<a href="https://www.analog.com/en/analog-dialogue/articles/ask-the-applications-engineer-25.html">ask-the-applications-engineer-25</a>中给出了普通运放驱动高容性负载的外部补偿方案，如下图左所示（ask-the-applications-engineer-25中的配图有误，运放的正负输入端画反了，下图是更正之后的）。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-06.jpg" alt="2-06" /></p>
<p>电路的原理大致为，使用Rx将运放与CL隔离，同时Rx与CF形成反馈网络中的高通路径，抵消CL带来的低通路径，最后由RF将大反馈环的反馈点接在负载处，保证幅值精度。具体的推导过程在AN-257中有详细的讲解，有机会我也会和大家介绍。</p>
<p>这种补偿方案需要在已知运放开环输出电阻和负载情况之后才能确定元件的取值，具有相当大的局限性，但值得尝试。因为我们在设计完一个模拟系统板后，用了多少颗去耦电容是明确的（你还记得你用了多少颗去耦电容吗~）。将上图左的反向比例形式改为右的单位增益跟随器形式，各参数计算暂且沿用（实际上是可以重新计算出的，敬请期待，咕咕）。</p>
<p>接下来就是实验的时刻了！我花了一下午在洞洞板上做好了测试电路（比画板子慢，但比等制版块呀，流水线操作当我没说）：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/2-07.jpg" alt="2-07" /></p>
<p>板子同时用上了双运放的两个单元，上半部分做成跟随器直接驱动和电阻隔离驱动二选一，下部分做成了补偿电路驱动，可以更换补偿电容CF。同时板子可以拔插设置不同的负载电阻和电容。</p>
<p>给运放供电9V，并使用信号源输入5V-0V，50Hz的方波，对电路的阶跃响应进行测试，从而考察稳定性（也是在模拟从9V的单电源产生虚拟地的过程）。负载电阻设置为1kR，相当于需要运放输出数mA级别的电流；负载电容设为330nF，模拟大部分模拟电路板卡上的去耦电容。</p>
<p>跟随器直接驱动高容性负载的结果如下图所示，不出所料，果然观察到了振荡现象。此方案的建立时间约为38us，振荡的幅度高达850mVpp，可以说完全不能接受。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/wave_r_1.jpg" alt="wave_r_1" /></p>
<p>接下来测试使用100R电阻隔离跟随器与负载的方案，可见此时输出稳定。这是因为隔离电阻降低了反馈网络的增益，破坏了振荡的幅度条件。但这种简单方案的缺点也十分明显：首先是建立时间增加到了73us，其次是输出有了稳态直流误差，约为420mV，而且这个误差会随着负载的变化而变化，造成的影响和上文1.3中提到的电阻分压方案的类似。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/wave_r_2.jpg" alt="wave_r_2" /></p>
<p>而当我们使用了补偿网络后，如下图，可见虽有振荡，但会快速衰减，而且最终输出的稳态直流电压是较为准确的。该方案的建立时间约为54us，稳定时间约为144us，上电时的电压过冲约为690mV。这些参数可以通过调整补偿网络参数来调节。可以说如果能接受过冲与稳定时间，补偿网络的方案很值得一用。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/wave_r_3.jpg" alt="wave_r_3" /></p>
<p>在以上测试中，我使用的信号源与示波器均来自ADALM2000。作为掌上虚拟仪器，它的性能是较差的，在示波器的时基调的较长时，采样率也会降低（本质是存储深度不足），这会带来一个严重的问题，如下与所示，虚拟地发生器的输出看上去一切正常：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/wave_r_4.jpg" alt="wave_r_4" /></p>
<p>但如果缩小时基观察，就会发现输出实际上是“毛茸茸”的，也就是振荡了。由于这个高频振荡的频率约为60kHz，所以在上一张图，示波器的采样率为10kHz时是无法展现的。因此我们在使用数字电源Debug时，一定要多切换时基大小进行观察，避免漏掉重要的细节。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/wave_r_5.jpg" alt="wave_r_5" /></p>
<h2 id="3虚拟地发生器的应用"><a class="markdownIt-Anchor" href="#3虚拟地发生器的应用"></a> 3.虚拟地发生器的应用</h2>
<p>按照2.2的设计方法，我们便可以根据应用场景选择更合适的运放搭建虚拟地发生器。</p>
<p>下图是CNPP设计的一个电池供电的低频高频增益放大器模块，使用了低功耗、低漂移的主放大器芯片，虚拟地发生器便也采用了低功耗运放LMV321（之后换成了功耗更低的SGM321）。由于是电池供电的系统，可以直接将虚拟地作为系统地，输入输出的参考地均接在这里，使用上不会有任何问题。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/3-01.jpg" alt="3-01" /></p>
<p>下面是另一个类似的设计——罗氏线圈的积分放大器测试板，左侧的运放作为虚拟地发生器。系统供电是一块9V电池，且用于前期测试，没有功耗需求，于是这里可以使用通用的单位增益稳定的运放，比如LM358。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/3-02.jpg" alt="3-02" /></p>
<p>对于实验电源供电的系统，也可使用虚拟地发生器。下图是CNPP制作的超低失真文氏桥振荡器，最左侧的LT1013的一个单元即作为了虚拟地发生器。不过在这种情况下，需要反复确认地线连接的正确与否。图中示波器探头的地线与实验电源的地线同接到了板卡的真GND上，也就是虚拟地产生之后的-Vs，然后在示波器上使用交流耦合就能正常进行测量的。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/3-03.jpg" alt="3-03" /></p>
<p>对于需要测量直流的情况，可以将实验电源设置为隔离（悬浮）输出，或是使用隔离电源模块，或是使用示波器的两个通道相减进行测量。</p>
<h2 id="4总结"><a class="markdownIt-Anchor" href="#4总结"></a> 4.总结</h2>
<p>之前提到，电源是我们整个旅程的起点，而今天给大家分享的虚拟地发生器电路更是陪伴了我大半年的时间，帮助我完成了许许多多模拟电路的新尝试（代价则是每做一块板子要多花半个小时来搭它），同时也成为了我深入了解运放的非理想特性以及系统稳定性的起点。</p>
<p>而终于在某一天Floyd-Fish老师给我寄来了用LT3471制作的USB转正负电源模块<strong>EmoeCBB-PR001A</strong>，这可是正经产生双电源的模块，不用再受虚拟地的限制，我也终于可以和半小时的额外劳动以及交流耦合暂告一段落了：</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog016-2023-01-23/4-01.jpg" alt="4-01" /></p>
<p>但这并不代和表虚拟地发生器就此别过，在之后的便携设备以及和数字系统交互的地方，依然会有它展现的时刻。同时CNPP也会在筹划中的开关电源探索系列之中，为大家带来单电源转双电源以及隔离双电源等的设计，敬请见证。</p>
<h2 id="5拓展及参考资料"><a class="markdownIt-Anchor" href="#5拓展及参考资料"></a> 5.拓展及参考资料</h2>
<p>虚拟地相关文章：</p>
<ul>
<li>Virtual Ground Circuits：<a href="https://tangentsoft.com/elec/vgrounds.html">https://tangentsoft.com/elec/vgrounds.html</a></li>
</ul>
<p>包含运放开环特性与稳定性的资料：</p>
<ul>
<li>《新概念模拟电路》：<a href="https://www.analog.com/cn/landing-pages/002/Analog-Circuit-compilation-yang.html">https://www.analog.com/cn/landing-pages/002/Analog-Circuit-compilation-yang.html</a></li>
<li>Linear Circuit Design Handbook：<a href="https://www.analog.com/en/education/education-library/linear-circuit-design-handbook.html">https://www.analog.com/en/education/education-library/linear-circuit-design-handbook.html</a></li>
</ul>
<p>运放如何驱动高容性负载：</p>
<ul>
<li>ADI AN-257 Careful Design Times High Speed Op Amps：<a href="https://www.analog.com/media/en/technical-documentation/application-notes/AN-257.pdf">https://www.analog.com/media/en/technical-documentation/application-notes/AN-257.pdf</a></li>
<li>ADI Simulation Shows How Real Op Amps Can Drive Capacitive Loads：<a href="https://www.analog.com/en/technical-articles/simulation-shows-how-real-op-amps-can-drive-capacitive-loads.html">https://www.analog.com/en/technical-articles/simulation-shows-how-real-op-amps-can-drive-capacitive-loads.html</a></li>
<li>ADI Ask The Applications Engineer-25: Op Amps Driving Capacitive Loads：<a href="https://www.analog.com/en/analog-dialogue/articles/ask-the-applications-engineer-25.html">https://www.analog.com/en/analog-dialogue/articles/ask-the-applications-engineer-25.html</a></li>
<li>ADI Ask The Application Engineer—32: Practical Techniques to Avoid Instability Due to Capacitive Loading：<a href="https://www.analog.com/en/analog-dialogue/articles/techniques-to-avoid-instability-capacitive-loading.html#:~:text=The%20ability%20of%20an%20op%20amp%20to%20drive,of%20output%20loads%2C%20input%20impedances%2C%20and%20stray%20capacitances.">https://www.analog.com/en/analog-dialogue/articles/techniques-to-avoid-instability-capacitive-loading.html#:~:text=The ability of an op amp to drive,of output loads%2C input impedances%2C and stray capacitances.</a></li>
<li>MicroChip AN884 Driving Capacitive Loads With Op Amps：<a href="https://ww1.microchip.com/downloads/en/appnotes/00884a.pdf">https://ww1.microchip.com/downloads/en/appnotes/00884a.pdf</a></li>
<li>How to Drive Large Capacitive Loads with an Op-Amp Circuit：<a href="https://www.allaboutcircuits.com/technical-articles/how-to-drive-large-capacitive-loads-op-amp-circuit/">https://www.allaboutcircuits.com/technical-articles/how-to-drive-large-capacitive-loads-op-amp-circuit/</a></li>
</ul>
<p>商品虚拟地发生器：</p>
<ul>
<li>TI TLE2426 The ‘Rail Splitter’ Precision Virtual Ground：<a href="https://www.ti.com/product/TLE2426">https://www.ti.com/product/TLE2426</a></li>
</ul>
<p>具有高容性负载驱动能力的运放：</p>
<ul>
<li>ADI LT1364：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/13645fa.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/13645fa.pdf</a></li>
<li>ADI AD817：<a href="https://www.analog.com/media/en/technical-documentation/data-sheets/AD817.pdf">https://www.analog.com/media/en/technical-documentation/data-sheets/AD817.pdf</a></li>
</ul>
]]></content>
      <categories>
        <category>模拟电路</category>
      </categories>
      <tags>
        <tag>GND</tag>
      </tags>
  </entry>
  <entry>
    <title>【EE随笔-4】Microchip公司几款接口简约的ADC和DAC</title>
    <url>/2022/09/28/blog015-2022-09-28/</url>
    <content><![CDATA[<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/title.jpg" alt="title" /></p>
<span id="more"></span>
<h2 id="随笔"><a class="markdownIt-Anchor" href="#随笔"></a> 随笔</h2>
<p>我一直想制作一块如Arduino Nano 般大小的FPGA板卡，来测试一些小的HDL代码片段，以及DSP算法。因为只是作原理验证和学习探索只用，没必要把处理的频率定的很高，在音频稍高的范围即可（比如50kHz以内），同时也更希望能把精力花在算法本身而不是外围电路的设计以及通信接口的调试上。因此，我时常回去留意一些性能未必出众，但接口简洁的混合器件上。</p>
<p>在校期间，我曾为EDA实验课程改进过一款配合FPGA开发板实用的DSP拓展版，也就是题图。在该板上就选用了Microchip公司的ADC和DAC，接口简单，效果也不错，于是就想到再把这两颗芯片找来看看：</p>
<p><strong>MCP3201</strong>：<a href="https://www.microchip.com/en-us/product/MCP3201">https://www.microchip.com/en-us/product/MCP3201</a></p>
<p><strong>MCP4901</strong>：<a href="https://www.microchip.com/en-us/product/MCP4921">https://www.microchip.com/en-us/product/MCP4921</a></p>
<p>手册在上面的链接里，请大家打开来看。</p>
<h3 id="mcp3201"><a class="markdownIt-Anchor" href="#mcp3201"></a> MCP3201</h3>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp3201-1.png" alt="1-1" /></p>
<p>MCP3201是一款12bit，SPI接口的ADC，采样率最高可达100ksps，可以说未必能达到不少单片机内置ADC的水平，可对于一块小FPGA来说，可是有和无的区别，做一些50kHz以内的信号处理实验，这个参数够用，而且SPI接口也是FPGA上最好写的通信接口之一。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp3201-2.png" alt="1-2" /></p>
<p>对于很多更高分辨率的ADC，转换时间是很可观的，在主机与它们通信时，通常要等待它们发来转换完成的信号，才能进行数据的读取。这样一来，要想保证均匀的连续采样，要么提前算好转换等待时间并加以适当延长后，作为采样周期去操作，要么全由ADC来主导采样周期，都很繁琐。</p>
<p>而MCP3201的分辨率不高，采样速度不快，通信接口的速度限定也比较慢，因此不需要等待转换完成的信号，直接在通信的前两个时钟周期它就转换完成了。每一次采样，只需要如上图读个16bit就直接完成，非常方便，就如同操作最简单的并口ADC一般。</p>
<p>可见，MCP3201的通信接口是很好设计的，当成一个16bit的移位寄存器读就行了。手册中还给出了分8bit两次读的方法，方便一些单片机使用。</p>
<h3 id="mcp4921"><a class="markdownIt-Anchor" href="#mcp4921"></a> MCP4921</h3>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-1.png" alt="2-1" /></p>
<p>12bit DAC MCP4921，建立时间4.5us，也就是差不多能做到200ksps，同样拥有很简单的通信接口。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-2.png" alt="2-1" /></p>
<p>美中不足的是没有内置基准，不过VREF脚接有Buffer，使用并联型基准时可以省去外置；Buffer还可以被旁路，没错，这其实是个乘法型DAC，在旁路掉VREF的Buffer和输出的Buffer之后可以作为数字电位器使用。可以说是很灵活了。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-3.png" alt="2-1" /></p>
<p>通信协议，16个bit配置完全部，很简单。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-4.png" alt="2-1" /></p>
<p>这款DAC另一个比较有趣的点是手册中给出的应用电路部分。比如上图展示了用两颗DAC分别控制信号幅度和偏置，很适合制作信号源时使用。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-5.png" alt="2-1" /></p>
<p>这张电路很难得地给出了用两颗DAC组合增加输出分辨率的方法，并给出了比例电阻的计算公式。</p>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog015-2022-09-28/mcp4921-6.png" alt="2-1" /></p>
<p>这里是作为乘法型DAC的应用，控制反馈环路的增益。</p>
<h2 id="完"><a class="markdownIt-Anchor" href="#完"></a> 完</h2>
<p>这几款ADC、DAC的价格不贵，封装也很小巧，一个FPGA挂上好几颗同步运行，或是作为辅助器件给高速ADDA控制偏置和增益等，岂不美哉。</p>
]]></content>
      <categories>
        <category>EE-随笔</category>
      </categories>
      <tags>
        <tag>ADC</tag>
        <tag>DAC</tag>
        <tag>Microchip</tag>
      </tags>
  </entry>
  <entry>
    <title>Ground Zero</title>
    <url>/2021/09/13/blog001-2021-09-13/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
            <p>一切的开端</p>

          </blockquote>
<p><img src="https://cnpp-image.oss-cn-beijing.aliyuncs.com/my-blog/blog001-2021-09-13/mgsv-gz-fox.jpg" alt="mgsv-gz-fox" /></p>
<p>现在的时间是2021年9月13日，我开始落笔写下第一篇博客。已然处于本科的随后一个秋季，保研的幻想已随着来去无踪的新冠疫情破灭，考研的决心却仍飘渺。在这些许已预料到的境遇之中，酝酿着慵懒颓唐的心态。</p>
<p>手头几个颇有挑战与乐趣的项目业已搁置，要考研。许诺之中的电赛，本是见面眼红的死敌，却被一道晴天霹雳击开的天堑隔开，对峙良久，反而成了面面相觑。在这样一个马鞍点上，收起悬而未决之意，反而略有闲心，操刀小烹，组织些珍视的图文于次僻所，聊解心头的熵结。</p>
]]></content>
      <categories>
        <category>生活-随笔</category>
      </categories>
      <tags>
        <tag>生活</tag>
      </tags>
  </entry>
</search>
